---
layout: post
comments: true
title:  "现代信号谱分析导论"
excerpt: "-"
date:   2019-03-13 16:42:24 +0000
categories: Notes
---

<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
---

# 现代信号谱分析导论

## 先修课程

本课程需要的先修课程为

- 线性代数
- 信号与系统
- 数字信号处理
- 随机过程

此处不对该课程内容做出过多的介绍。

## 概述

我们日常看到的信号都是随机信号。在通信与雷达中，我们的接收信号永远是一个依某种概率分布的信号，我们要根据这个结果进行对结果的“猜测”，从而得到正确的结果。详细内容不多介绍。信号谱分析也是一个相似的学科。我们接收到的同类型信号往往是一个随机过程，我们永远不能获取该过程的所有实现`implementation`，但是我们在单次测量中一定能依一定精度获取一个随机序列。注意单次随机过程仍是一个连续过程，但是我们的测量却只能获取一个离散序列。当然，如果我们以奈奎斯特频率以上的频率进行采样（实际中往往都是过采样），则能获取其中的全部信息，并且能通过滤波器将其完全恢复。因此我们就可以

> 根据这一个随机过程的实现的片段，估计整个信号的功率谱分布。

不过这是我个人的总结，书中介绍为

> 根据观察到的样本数据集估计平稳信号的总体功率谱

实际上《现代信号谱分析》这本书就是讲解这一部分内容，这句话就是全书的中心思想。

对信号谱进行估计是一个很值得研究的学科，目前也有很多人对该方向进行研究。信号谱的分析一般分为两类方法，这也是本册课程后面会重点讲到的内容。一类是**经典谱估计方法**，另一类是**现代谱估计方法**。两类方法主要内容如下

- 非参数化方法（经典谱估计方法）

    依赖于傅里叶变换的方法，有**相关图**法、**周期图**法等。

- 参数化模型方法（现代谱估计法）

    依赖于现有模型的方法，建立一个含较多参数的模型，然后根据信号的特点对这些模型的参数进行估计，最后将模型直接转化为功率谱的形式。常见的有自回归方法、最大熵法、最大似然估计法、超分辨率法等。

## 谱分析基础

首先我们对功率谱进行一个简单定义。功率谱的本质应该是对整个随机过程的全部实现进行功率谱计算并求平均的方法，因为一个随机过程的实现很多，单次实现很可能并不能完整代表整个过程（当然有各态历经性这个性质，利用一次实现就可以估计整个随机过程的数字参数）。

那么功率谱密度的定义就是



$$
\begin{equation}
\begin{split}
P_x(\omega)=\sum\limits_{m=-\infty}^{+\infty}r_x(m)e^{-j\omega m}
\end{split}
\tag{1}
\end{equation}
$$


这个定义实质上是维纳辛钦定理的表达。这里对该定理不做证明，但是该定理揭示了随机过程的**自相关函数**与随机信号的**功率谱密度**是一对傅里叶变换对。对于从未接触过相关内容的人，此处对其性质做出一些解释

- 随机信号的自相关函数，由于本身信号是采样结果，因此我们认为相关函数也是离散形式的。但是由于做了一个离散时间傅里叶变换，这里根据傅里叶变换的性质，功率谱密度是一个连续量。

- 一般随机过程的自相关函数都是非周期的，不过也是存在例外的。如果我们的自相关**序列**（这里注释一下，对于离散的信号来说，自相关**序列**比自相关**函数**更加符合）是非周期的，那么此时一个重要的性质为

  
    $$
    \begin{equation}
    \begin{split}
    r(0)=\overline{P}=\int_{-\pi}^{+\pi}P(\omega)d\omega
    \end{split}
    \tag{2}
    \end{equation}
    $$
    即周期功率谱密度在一个周期内的积分。这个表达式不唯一，至于为什么是周期的，这个需要自己查《信号与系统》

- 随机信号的自相关函数和功率谱密度分别从**时域**和**频域**反映随机序列的**二阶统计特性**

---

一个平稳随机信号可以分解为两个互不相关的随机振幅简谐振动的叠加。如果是一个窄带过程，则可以表达为**莱斯形式**，否则我们可以将其叠加为



$$
\begin{equation}
\begin{split}
x[n]=\sum\limits_{k=1}^{N}(a_k \cos n\omega_k +b_k \sin n\omega_k)
\end{split}
\tag{3}
\end{equation}
$$


其中两个随机振幅是均值为$$0$$，方差为$$\sigma^2$$的高斯过程，联合平稳。

自相关函数保存了序列的全部频率成分，并且依能量的形式保存了振幅的信息。

---

## 统计估计基础

统计估计使信号处理中一个常用的手段，实际上专门有学科为**统计信号处理**。说明白一点，统计估计这部分的目的就是，如何更好地**用随机信号的一次样本实现的有限长数据估计统计特征量**。统计特征可以是均值、方差等，也可以是相关序列与谱等。实际上我们这里使用统计更多时候是评估谱估计方法的性能。

根据观测数据来推断某个量$$\theta$$的过程称为统计估计问题，设随机过程$$X(n)$$的某个数字特征量的真值为$$\theta$$，但是我们并不知道，只能根据已知的短暂的序列对这个参数进行估计，估计值一般记为$$\hat \theta$$。显然我们的估计值是根据序列$$x$$得到的，因此我们认为


$$
\begin{equation}
\begin{split}
\hat\theta=f(x)
\end{split}
\tag{4}
\end{equation}
$$



我们这里的函数$$f$$不仅可以是线性函数，也可以是其他非线性函数，为了衡量估计的近似程度，我们一般引入若干指标

- `bias`，即**偏差**。

  
    $$
    \begin{equation}
    \begin{split}
    bias[\hat\theta]=E\{ \hat\theta - \theta \}
    \end{split}
    \tag{5}
    \end{equation}
    $$
    若偏差为$$0$$，就是**无偏估计**，若在取样点数趋于无穷时偏差也趋于$$0$$，则被认为是**渐近无偏估计**。

- `var`，即**方差**

  
    $$
    \begin{equation}
    \begin{split}
    var[\hat\theta]=E \{ (\hat\theta - E\{\hat\theta\})^2 \}
    \end{split}
    \tag{6}
    \end{equation}
    $$
    样本方差我们学过很多次了，就是描述各次估计相对于估计均值的偏离程度。

- `mse`，即**均方误差**

    均方误差的定义为

    
    $$
    \begin{equation}
    \begin{split}
    mse[\hat\theta]=E\{(\hat\theta - \theta)^2\}=var[\theta]+(bias[\hat\theta])^2
    \end{split}
    \tag{7}
    \end{equation}
    $$
    如果均方误差是$$0$$，我们说这还是一个一致估计；如果均方误差在点数趋近于无穷的时候逼近$$0$$，我们就说这是一个渐近一致估计。

---

接下来简单介绍一下相关参数的估计方法。

首先是我们关于**均值**的估计。对于一个因果稳定的系统，均值就是直接求和除以点数，这就是简单的求平均。需要注意期望与均值实际上不是相同含义，期望一般是统计意义上的平均，这时我们认为是对随机过程的所有实现进行统计；但是均值就是简单的求平均过程。

然后简单说以下**方差**的估计。这里的方差就是均值与实际数值之间差异的平方的平均值。由于样本有限，因此仍然是有限点数的平均结果。如果我们有


$$
\begin{equation}
\begin{split}
bias[\hat\sigma_X^2]=0
\end{split}
\tag{8}
\end{equation}
$$



我们就说这个方差的估计是$$\sigma_X^2$$的无偏一致估计。

对于自相关序列的估计，一般有两个方法。一种是


$$
\begin{equation}
\begin{split}
\hat r_x(m)=\frac{1}{N}\sum\limits_{n=0}^{N-1}x_N(n)x_N(n+m)
\end{split}
\tag{9}
\end{equation}
$$


这个估计是最常用的估计。因为点数是有限的，因此在位移求乘积并均值的过程中，不同位置求和的点数不同。例如在计算$$\hat r(0)$$的时候，我们是$$N$$个点计算，所以除以$$N$$是没有问题的；计算其他位置的时候，求和点数就会下降，但是此时我们仍然除以$$N$$，这就是这个方法估计的特点。

这里不加推导地说明，该估计是一个有偏估计，偏差为


$$
\begin{equation}
\begin{split}
bias[\hat r_x(m)]=-\frac{\mid m \mid}{N}r_x(m)
\end{split}
\tag{10}
\end{equation}
$$


这个估计是个有偏估计，但是随着取样点数$$N$$的增加，这个结果是渐近无偏估计。

对这个算法进行进一步的理解，我们可以发现，实际上这个估计就相当于给相关函数加了一个三角窗。

另外此算法的方差在$$N\to \infty$$的时候趋向于$$0$$，因此是一个渐近无偏**一致**估计。

另一种方法是


$$
\begin{equation}
\begin{split}
\hat r_x(m)=\frac{1}{N-\mid m \mid}\sum\limits_{n=0}^{N-1-\mid m \mid}x_N(n)x_N(n+\mid m\mid)
\end{split}
\tag{11}
\end{equation}
$$


这个方法的本质就是在处理均值的时候严格按照求和点数进行。这样可以保证所有的均值都是基于求和点数的，不会出现上述的加三角窗的情况，而且是一个**无偏一致估计**，但是当我们的$$m$$增大的时候，方差会远大于上一种方法。

> 实际上相关函数的估计，按照上述的两种方法来看，就是一个求平均的差异，参与平均的数据越多，靠近中心位置的估值就更加可靠，但是显然点数是有限的，因此估计的时候就会产生误差，这也就是功率谱估计的误差的来源。
>
> 另外这个自相关序列的估计还有一个要求，即DTFT为非负的。因为DTFT的结果是功率谱密度，功率谱密度不能出现负值。以上两种估计，虽然第一个相当于加了三角窗，但是功率谱确实非负的，因此实际中往往也使用这种。

---

### 功率谱及其估计

介绍完了基础理论，这里要开始介绍主要内容了。

确定性信号一般我们认为是能量信号，傅里叶变换就是信号的频谱特征。但是如果是随机信号就不一样了，一般我们认为随机信号是一个无限长信号，是一个功率信号，我们不能根据定义计算傅里叶变换，如果通过某种手段进行了计算，其“频谱”也是对功率的反映。

根据功率谱的定义，功率谱应该是需要计算无穷多的测量数据，实际上我们做不到，只能通过估计的方法尽可能地接近这个值。首先我们看一下**经典谱估计**方法。

### 经典谱估计（基于傅里叶变换）

经典方法嘛，大概是因为参数化方法还没有发展出来，人们就利用傅里叶方法进行近似了。根据维纳辛钦定理，我们可以知道


$$
\begin{equation}
\begin{split}
P_x(\omega)=\sum\limits_{m=-\infty}^{+\infty}r_x(m)e^{-j\omega m}
\end{split}
\tag{12}
\end{equation}
$$

$$
\begin{equation}
\begin{split}
r_x(m)=\frac{1}{2\pi}\int_{-\pi}^{+\pi}P_x(\omega)e^{j\omega m}d\omega
\end{split}
\tag{13}
\end{equation}
$$



不过一般来说功率谱的定义式我们还是采用


$$
\begin{equation}
\begin{split}
P_x(\omega)=&\lim\limits_{M\to \infty}E\left \{ \frac{1}{2M+1}\mid \sum\limits_{m=-M}^{+M}x(n)e^{-j\omega n} \mid^2 \right \}\\=&\lim\limits_{M\to \infty}E\left \{ \frac{\mid X(\omega) \mid^2}{2M+1} \right \}
\end{split}
\tag{14}
\end{equation}
$$


这个定义我们就可以看出，功率谱实际上是一个随机信号的无穷多次实现的截断频谱的统计平均。

### 周期图法（直接法）

周期图法是根据观察到的信号直接估计。最简单的估计式为


$$
\begin{equation}
\begin{split}
\hat P_{PER}(\omega)=\frac{1}{N}\mid X_N(\omega) \mid^2
\end{split}
\tag{15}
\end{equation}
$$


式中的截断频谱就是我们观测到的截断信号的`DTFT`。上式还可以写成离散形式（单位圆取样）


$$
\begin{equation}
\begin{split}
\hat P_{PER}(k)=\frac{1}{N}\mid X_N(k) \mid^2
\end{split}
\tag{16}
\end{equation}
$$


这种估计是渐近无偏的，由于其计算方法，实际上相当于是对功率谱加了三角窗。从方差来看，由于其方差并不随长度$$N$$增加而减小，因此我们认为该方法并不是一致估计方法。

### 相关图法（间接法）

首先估计相关函数，然后通过相关函数的方法进行谱分析。这个估计方法实际上就有些**参数化方法**的意思了。


$$
\begin{equation}
\begin{split}
\hat P_{BT}(\omega)=\sum\limits_{m=-M}^{+M}\hat r_M(m)e^{-j\omega m}
\end{split}
\tag{17}
\end{equation}
$$


这里用的自相关序列的估计值就是上述的第一种方法，虽然是一个有偏估计量，但是却可以处理为加窗的效果，在计算中可以简化。

这种方法的偏差与方差是一个`trade-off`问题，如果要使偏差小，就需要足够多的点数，此时窗函数的傅里叶变换才会接近$$\delta$$函数，但是此时方差又会增大，因此这种方法需要进行折中选择。

---

如果我们将原信号序列$$x_N(x)$$进行补零（补$$N$$个零），此时进行周期图法计算，得到的结果相当于$$N$$点的相关图。另一种角度我们可以认为是，用一个长度为$$2M+1$$的矩形窗函数截断最大长度为$$2N-1$$的$$\hat r$$。这个过程相当于给真实的自相关序列加了两个窗，其中矩形窗的作用类似于平滑处理，因此我们可以认为相关图法是周期图法的平滑改进。但是由于相关图法可以使用傅里叶变换快速实现，因此相关图法也更为常用。

### 经典谱估计方法小结

- 计算简单，可以用`FFT`方法加速运算，物理意义清晰。
- 谱分辨率低，不可避免的加窗会导致频谱泄漏。
- 方差大（谱的波动大）
    - 缺少均值和极限运算

针对上述缺点我们可以进行重点改进，例如使用其他窗函数进行截断，使得结果更加平滑。

> 在DSP课程中我们学过，窗函数的主瓣宽度主要决定谱的分辨力，而旁瓣决定谱的泄漏。一般我们会比较喜欢主瓣较窄而且旁瓣较低的窗函数，不过很遗憾这两个参数也是一对`trade-off`

- 平均周期图法
    - 对一个随机变量进行连续观测时，收集$$L$$组独立记录数据，可以将这些数据进行功率谱的平均处理，这样可以将方差降低。
- 窗函数法
    - 用一个适当的功率谱窗函数与周期图进行卷积，使得周期图平滑。前面采用的窗函数是三角窗和矩形窗，此处可以选择`Kaiser`窗或者`Blackman`窗等。
- 修正的周期图求平均法
    - 这里的方法是对长度为$$N$$的信号分成$$L$$段，然后将窗函数加到每一段数据中，求出每一段的周期图，形成修正的周期图，最后对周期图做平均处理。我操这要是数据量比较小的话得糊成啥样。
    - 实际上在分段的时候还可以出现重叠，例如做$$50\%$$的重叠

以上，无论以什么为代价总是以减少分辨率为代价换取估计方差的减小，提高分辨率的问题始终不能解决。

**那么提升分辨率应该怎么解决呢？**反正经典谱估计方法都是不能解决的。

参数化模型这里先不进行介绍。

---

以上是非参数化方法的简单介绍，是一段简单的谱分析课程带入。下面将正式介绍两种方法，参数化与非参数化法。

## 非参数化方法

稍微**详细**地说明一下非参数化方法。前面说过非参数化方法的本质就是，通过傅里叶变换的方式对功率谱进行估计分析。

> 这里多一句嘴，一般说到**分析**就是积分。这也是为啥会出现那么多傅里叶分析的原因。

傅里叶变换的到的是频谱，通过平方操作就能得到功率谱。

`2019-4-17 20:22:41`

什么是功率谱估计？通过一段有限长的平稳序列，我们估计总功率是如何在频率分布的，这就是功率谱估计。前面该讲的基本都说过了，这里直接进入主题。

### 随机信号功率谱密度估计

假设我们有一个宽平稳随机信号，它的相关函数一定是共轭对称，在$$0$$处取得极值且大于零的。如果写成相关矩阵的方式，则一定可以证明，这个相关矩阵是半正定的。因此所有的特征值都是大于等于零的。

相关矩阵有`Toeplitz`性，而且是`Hermitian`阵。如果做特征值分解，我们可以采用酉矩阵进行分解，酉矩阵是归一化特征向量按列排布。

---

`先简单复习一点信号相关内容`

知道了这些基础知识以后，我们先复习一下功率谱密度的**第一定义**，相关函数的傅里叶变换。*由于我们是离散信号的计算，因此傅里叶变换谱一定是周期的，我们这里只考虑一个周期内的结果。*以及**第二定义**，信号傅里叶变换的平方的**统计平均**值（宽平稳的随机信号）。

谱估计都要从定义下手。

功率谱密度有一些性质，我们可以用来判断估计结果是否优秀，例如一定是非负的，且共轭对称。

另外对于一种常见的随机信号，即通过线性时不变系统的信号。功率谱可以直接乘线性时不变系统的系统函数的平方，还有若干性质可以简单参考一下课本。

---

那么现在就是谱估计问题了。假设我们有一段长度为$$N$$的离散信号，谱估计为$$\hat P(\omega)$$。我们首先对**第二定义**下手。第二定义中，我们需要无穷多的点数，进行无穷多点傅里叶变换的平方的均值运算，但是手里只有$$N$$点信号，所以只能用这些结果进行估计。原本为
$$
P(\omega)=\lim_{N\to \infty}\mathbb E\left\{ \frac{1}{N}\mid \sum_{n=0}^{N-1}x(n)e^{-j\omega n} \mid^2 \right\}
$$
现在只有有限点数，就只能写作
$$
\hat P(\omega)= \frac{1}{N}\mid \sum_{n=0}^{N-1}x(n)e^{-j\omega n} \mid^2 
$$
利用手里有限的信号，我们只能得到一次实现结果，不能求统计平均。另外只有$$N$$点数据，就不能做极限运算。这个就是功率谱的估计结果。这个估计我们称为**周期图法**，这种估计方法得到的功率谱是非负的，对于实信号还会得到偶对称的结果。

另外一种方法就是对**第一定义**下手，这种方法被称为是**相关图法**，对相关函数进行估计，然后对估计结果进行傅里叶变换。一般来讲对相关函数的估计有很多方法，这里介绍两种，**有偏**估计法和**无偏**估计法。

对于**无偏**估计法，一般采用如下形式
$$
\hat r(k)=\frac{1}{N-k}\sum_{i=k}^{N-1}x(i)x^*(i-k)
$$
这样对其求均值后得到的结果与理想相关函数是相同的。但是无偏估计，虽然没有偏置，但是估计出来的结果**存在负值**。这种估计对多少点求和，就对多少点求均值，随便举个例子就会发现结果是存在负值的。当$$k$$足够大的时候，这个估计结果就会距离真实结果偏离太多，只有无偏估计这一个优点。这个像是加了**矩形窗**

但是**有偏**估计在这一点上就会好很多。
$$
\hat r(k)=\frac 1 N \sum_{i=k}^{N-1}x(i)x^*(i-k)
$$
显然这个时候，越远的信号，相关函数值就会越小，因为分母一直都是固定值，但是相关时参与运算的数越来越少。不过这个结果也是渐近无偏的，当点数无穷多的时候，还是无偏估计的。这样操作之后就像是加了三角窗，功率谱不会出现负值。虽然是相关函数的有偏估计，但是相关矩阵还是半正定的。怎么看都是有偏估计方法比较好。

---

周期图法和相关图法给出的估计结果都不是很让人满意，至少方差都比较大，而且优化起来有困难。因为我们只有一次实现，这样的估计对于随机过程而言存在太大的偶然性。不过周期图法由于采用了傅里叶变换方法，因此可以简单计算为
$$
\hat P(k)=\frac 1 N \mid X(k)\mid^2
$$
这样可以降低乘法运算次数，从而简化运算。其实相关图法也存在傅里叶变换的部分。

简单分析完两种最最最简单的估计方法，我们总结一下，一个优秀的谱估计算法需要小的偏差，小的方差，以及一致性（当点数趋近无穷的时候，估计结果趋近理想）。这些方法中我们并没有介绍应该如何去设计估计算法，实际上有《信号检测与估计》这么一个课程专门介绍。这里简单说几句。首先，对于一个有高斯扰动的信号，我们采用最大似然法尝试估计。
$$
y=a+n
$$
对于测量到的结果，我们尝试采用最大似然的方法，这种方法的主要思想就是找到条件分布函数，让后求导求解极值点。这个点是概率最大的位置，我们认为这是最大似然位置。假设我们测量得到结果是$$5$$，我们想要找到一个最可能令测量结果为$$5$$的$$a$$。那么显然我们让$$a=5$$就是最优解。

如果我们测到的是三个点的数据呢？如果测量结果是独立的，联合密度函数就可以直接相乘，求得极值点应是三者的均值。此时方差变为原来的$$1/3$$。这也解释了多次测量降低误差的原因。

如果现在不是高斯分布的扰动，而是均匀分布的扰动。如果我们只测到了一个点，那么我们根据最大似然发，会认为这个点就是分布的上限。同理，多个独立测量点时，我们的计算结果是若干测量值中最大的一个。

---

克拉美-劳界是一个估计理论中的重要界。我们这里不追究是如何推出来的，但是我们可以说，任何估计方法的误差都不会比这个下界小。另外施瓦茨不等式，两个函数相乘积分值的上界是独自平方积分的平方根的乘积。

关于有效估计，我们认为，无偏估计，并且达到了`CRB`下界的估计就可以认为是有效估计。这有个例题有空可以做了。如果一个估计是无偏的，那么他的方差一定高于`CRB`；如果一个参数的有效估计存在，那它的最大似然估计一定是有效估计。如果一个参数的有效估计不存在，那么最大似然估计的性能取决于具体问题。没有什么估计器的结果能全部满足这个下界。

---

前面算是对估计理论的介绍。我们反过来看看周期图法。周期图法是采用估计相关函数的方式进行估计。如果我们采用的是**有偏**估计的相关函数，那就相当于给相关函数加了三角窗。功率谱就乘了`sinc`的平方。如果采用了**无偏**的相关函数，那么就相当于给相关函数做了矩形窗截断。矩形窗在功率谱的作用就相当于是平滑了，其实对与其他窗函数而言都是这个效果，这样的平滑会导致分辨率下降——如果两个频率比主瓣宽度还近，那么这种算法就不能有效地分开这两个信号。矩形窗的分辨率$$\frac 1 N \:Hz$$成为了一个分辨率标准，是周期图法的分辨率上限。点数越多，分辨率越高，但是总是有限的。另外也正是窗函数的各种频谱（以旁瓣为代表），导致出现了各种频谱泄漏。窗函数的平滑和泄漏导致了峰值的扁平化。不过随着点数增加，估计的偏差会下降。

方差分析看不懂PPT在讲什么飞机。如果噪声是零均值的复高斯白噪声，我们认为周期图法是一个无偏估计。但是方差性能实在是过于复杂，这个一定要在复习的时候好好看看。总之周期图法不是一个一致估计。

---

为了改善方差性能，我们一般通过增大偏差或者降低分辨率的方法进行。传统方法的弊病可以说体现在这里了。

`Blackman - Tukey`

实际上是改善了**相关图法**的相关函数的估计。给相关函数增加一个延迟窗。窗上加窗，得糊成啥样啊。这样就降低了分辨率，但是可以有效降低方差。这种估计方法实际上就是又给功率谱做了加权平均罢了。这个窗的长度越小，出来的分辨率就越差，不过方差也会随之降低。如果说窗的长度为$$M$$，则分辨率就是正比于$$\frac 1 M$$，方差正比于$$\frac M N$$。加窗后的相关矩阵也是半正定的，可以自己算——只是相当于相关函数与窗函数矩阵的哈达玛积。



> `Time - Bandwidth Product`
>
> 时间带宽积问题。这里可以算出来一个结果，即等效时间长度与等效带宽（都是等效为矩形）的乘积是定值——$$N_e\beta_e=1$$。这说明一个信号在一个域衰减越慢，在另一个域就越集中。不同的窗函数就可以这样解释，在时间域内的衰减水平就会决定频域上主瓣宽度与副瓣衰减。矩形窗时域衰减巨慢，就不衰减，于是矩形窗是主瓣最为集中的。
>
> 实际上人们根据种种理论已经有了一个合理的窗函数设计方法，对于相关图法的窗函数设计，基本上已经没有了什么新意。在什么问题下就涉及什么样的窗函数即可。一般准则为窗宽度为信号点数的$$\frac 1 {10}$$，在实际应用中的分辨率与方差中进行一定折中，并且功率谱为正。
>
> 目前而言所有的估计方法都是在牺牲分辨率的条件下换取方差下降。

`Bartlett Method`

信号是一个$$N$$点序列，我们将其分为$$L$$部分，每部分长为$$M$$。这样我们可以对每一小段进行估计，然后对所有的估计结果进行平均计算，从而替代统计平均的效果。这个估计结果也是全正的，数据较多时与上述方法采用矩形窗的效果无异。

`Welch Method`

信号复用算法，此时允许重叠复用（最大重叠$$50\%$$），重叠复用后降低了方差，一般会比`Bartlett Method`更低，但是已经不明显。这种方法也算是揪着一个创新点打滚的算法了（笑）

`Daniel Method`

对周期图法的功率谱密度做积分平均。这他妈要多糊有多糊。这个也可以说是`Blackman - Tukey`的一个特例。

个人看法，这些算法都是想办法对结果进行平滑，有点像现在的音响行业堆参数的样子。只要我想把参数降低，我有的是办法，例如总谐波失真，在`1000Hz`的`THD`降低有很多方法，最简单的就是加入深度反馈，这时候谐波的失真可以达到非常小，但是在音乐播放的过程中就会发现，他只能降低谐波失真而已，音乐的失真一样很大。

---

复习的时候一定不能忘记看

- 方差性能分析
- 最大似然估计
- BT法的相关矩阵证明
- LDA方法



## 参数化方法

也被称作有理谱估计。例如我们并不对信号进行估计，先用概率分布举个例子。我们知道一维高斯分布只有两个参数，知道这两个参数就可以确定高斯分布，即一阶矩和二阶矩。表达式中只要知道了均值与方差，我们就可以还原出高斯分布，从而实现概率密度的估计。功率谱的参数化估计与这个思路相似。非参数化估计方法对于功率谱密度没有任何先验知识，不确定量太多，因此惠山城较大的方差。参数化估计方法需要我们对功率谱密度有一定的先验知识，基于这个条件再进行估计。

还是以高斯分布为例，我们知道了几次实现之后，也许很难知道是遵从高斯分布的，但是如果知道是高斯分布，就能根据这个先验知识进行一二阶矩进行估计。

`Parsimony Principe`

可以说是简约原理，一般来讲模型中的未知参数越少，我们的估计就越好。设计一个参数很多的模型，其估计存在的局限就有可能更多，想要更好地估计往往需要更多的信息。

除此之外我们还需要准确的数据模型，错误的模型一般都会导致错误的估计结果。下面介绍一下参数化方法的理论依据。

`Rational Spectra`
$$
P(\omega)=\sigma^2\mid \frac{B(\omega)}{A(\omega)} \mid^2
$$
其中，$$A(\omega)=1+a_1e^{-j\omega}+...+a_pe^{-jp\omega}$$，$$B(\omega)=1+b_1e^{-j\omega}+...+b_qe^{-jq\omega}$$。我们认为$$a,b$$这些参数都是实参数，并且通过这种方法，任意连续功率谱密度都可以被任意高精度地逼近。那么我们就可以得到任意的功率谱密度。由于如表达式所述的系统一般都是物理可实现的，因此我们可以根据我们期望的结果任意设计滤波器$$B(\omega)$$和$$A(\omega)$$。所有信号都可以表示为白噪声激励某一线性系统的结果。

这个表达式还可以写成另一种形式。
$$
x(n)=-\sum_{k=1}^p a_k x(n-k)+\sum_{k=0}^qb_k u(n-k)
$$
这个应该比较好理解。实际上在说的意思是，这是一个滑动平均自回归信号模型。

我们还可以写成$$Z$$变换形式，相当于就是把传递函数都改写成$$z=e^{j\omega}$$的形式。

$$A(z)=1+a_1z^{-1}+...+a_pz^{-p}$$

$$B(z)=1+b_1z^{-1}+...+b_qz^{-q}$$

结果已经昭然若揭。实际上我们就是想介绍一下`ARMA`模型。这个模型可以拆成两部分，分别自回归模型和滑动平均模型。一般我们认为

- `AR`自回归模型能够更好地刻画尖峰`PSD`
- `MA`滑动平均模型可以更好地刻画低谷`PSD`
- `ARMA`模型可以更好地描述尖峰与低谷

谱分解定理应该都学过了，意思就是功率谱可以依零极点进行分解，零极点一定是成对存在的，极点一般出现在单位圆内外的位置，互为倒数，零点一般成对出现，关于实轴对称。

> 我们一般会选择零极点均在单位圆内的系统。注意为什么这里说单位圆内外都有零极点，但是这里说选择单位圆内部的结果。因为系统的零极点只有一个，但是功率谱的零极点是成对出现的。这里看一下谱因子分解定理就能明白。为了简化问题，这里不选择复数因子。设计精巧的系统，往往会选择单位圆附近的零极点。这样可以保证系统易于调整，而且还能保证系统稳定。

`ARMA`及其分解的子模型之间存在内在联系，一个有限阶数的`AR`模型相当于一个无穷阶数的`MA`模型，反之亦然。这里只要学过长除法就可以自行推导。相同的是，一个`ARMA`模型也可以写成无穷阶的`AR`或`MA`模型。

> 整理一下思路，我们首先根据有理分式的相关定义，知道了一个信号可以表示为白噪声激励任意系统，然后根据这个系统的离散形式，导出了`ARMA`模型。根据`ARMA`模型的结构，我们知道，只要知道了这个模型的参数，就能较为完美地还原出信号的功率谱。我们这里需要明白，这个模型在这个算法中对信号重建的能力有限。实际应用的时候由于实际信号存在误差，且未必完全满足这个模型，因此在实际使用的时候，信号都会被允许在一定的误差内进行拟合。

### AR Signals

自回归信号。此时白噪声激励的系统函数一般是
$$
H(z)=\frac{1}{A(z)}
$$
这时模型的一半，`AR`模型。这是一个全极点传递函数，`PPT`上写的不是很对。这里应当是输出的线性组合等于输入。用一种方便的表达，我们说
$$
A(z)x(n)=u(n)
$$
其中$$u(n)$$是一个零均值高斯白噪声。后面的运算涉及矩阵的操作，这里就不打了，太费劲。展开$$\mathbb E[x(n)u(n)]=\sigma^2$$以及$$\mathbb E[x(n-k)u(n)]=0$$，写成矩阵的形式，得到
$$
\boldsymbol R\boldsymbol a=-\boldsymbol r
$$
当我们和上面一样只有$$N$$个数据的时候，不能获得原来的相关序列，那么就只能获取相关序列的估计$$\hat r(k)$$。上述方程被称为是`Yule - Walker`方程。解上述方程，就能获取$$\boldsymbol a$$序列，就成功估计了`AR`模型中的参数，从而可以直接估计功率谱。解这个方程需要较高的运算量，尤其是需要矩阵$$\boldsymbol R$$求逆。因此实际应用中我们采用`Levinson - Durbin`方法进行快速计算（我先盲猜，这个地方要用逆矩阵的递推算法）。经过权威调查，矩阵求逆的复杂度是$$O(n^3)$$级别的。

需要提醒一点，`AR`模型是实际应用中最为常用的一种算法，因此对`AR`信号的估计以及快速运算是一个讨论火热的话题。话说回来即使是对于`MA`信号进行计算，结果也是差不多的。

如果我们估计的相关序列是一个正定的序列，那么我们求解的$$\boldsymbol a$$序列组成的滤波器的极点就都在单位圆内，而且是一个有界输入输出的（稳定的）。其实单位圆内和稳定好像是一个意思。前面也说了有偏和无偏估计的相关序列的特点，这里考虑到正定性，最好是采用有偏估计。

`Levinson - Durbin Algorithm`

复杂度为$$O(n^2)$$级。

有空自己跟着推一遍，这里简单复习就不看了。居然还有例题太良心了。

### MA Signals

滑动平均信号。
$$
H(z)=B(z)
$$
白噪声信号通过系统后
$$
x(n)=B(z)u(n)
$$
符号意义与上面相同。我看这里算出来和`AR`信号模型不太一样啊。但是我没觉得哪里不一样啊。计算出相关序列之后可以直接进行傅里叶变换，得到功率谱的估计。这个其实就是矩形窗的`Blackman - Tukey`算法啊，这不傻逼么。但是问题来了，无论我们估计的相关序列是有偏估计法还是无偏估计法，最后得到的结果都是有可能出现负值的。这就奇他妈了个怪了。不过想想也正常，既然是又加了个矩形窗，那结果出现负值不是很正常的事么。

> 相关图法利用的是相关函数估计。采用无偏估计的相关函数相当于矩形窗截断，采用有偏估计的相当于三角窗截断，前者会出现负值，但是后者不会（废话）。`Blackman - Tukey`方法相当于又加了一个窗，延迟窗。窗上加窗，糊上加糊。



### ARMA Signals

这种信号模型也被称为是零极点模型。两侧等式都写成矩阵的形式，然后尝试求解相关序列。

最后组合成矩阵，采用`YW - Equation`的方法求解。这里是`Modified`方法，推导过程记得自己看一下。

注意这里利用估计的相关序列，我们能计算$$a$$的估计值。

然后对于滑动平均部分的$$b$$部分，我们可以把`MA`部分的功率谱用$$a$$来表示。把这一部分直接当成滑动平均模型计算，这样就可以直接把功率谱估计出来了。由于`MA`部分的存在，仍然可能出现负值，如果原信号十分稳定（零极点在单位圆内内内内内部十分靠里面），那估计结果有可观的准确性。不过当零极点十分接近单位圆的时候，估计结果很差。这时的信号一般是窄带信号。

后面有个例子自己看看。

`Over Determined Equations`

另外在这类问题中，由于我们获取了较多的点数，一般来讲往往希望将所有的点数都用上。不过方程超定且存在误差的时候，解就不唯一了。这时候可能采用最小二乘方法`Least Squares`。

此时的解法简单介绍一下，定义残差
$$
\boldsymbol e=\boldsymbol A\boldsymbol x-\boldsymbol b
$$
然后计算欧几里得范数$$\boldsymbol e^H\boldsymbol e$$，其实就是平方和。然后最小化范数误差，得到
$$
\boldsymbol x=(\boldsymbol A^H\boldsymbol A)^{-1}\boldsymbol A^H\boldsymbol b
$$
这个推导实在是太简单的简单到我自己都会。

这里给一个正规方程。对于我们的超定方程组
$$
\boldsymbol A\boldsymbol x=\boldsymbol b
$$
我们左乘矩阵
$$
\boldsymbol A^H\boldsymbol A\boldsymbol x=\boldsymbol A^H\boldsymbol b
$$
这个方程就被称为是正规方程。解法不做要求，一般采用上下三角分解，`QR`分解等方式。

注意上下三角分解的方式对误差十分敏感。相比之下`QR`分解在数值误差上就不是那么敏感了。

后面还介绍了一个`Total Least Squares`的算法，不过我没看。

---

---

---

---

---

---

---

---

---

---

## 复习提纲

### 1. 2015级B卷

1. 截断ACS是否是有效ACS？
2. 有效ACS的傅里叶变换是非负数，其部分序列的傅里叶变换是否有效？
3. 证明采用标准有偏ACS时，周期图和相关图方法是一致的



### 2. 作业解析

#### 第一章

1. 线性系统输出功率谱密度表达式。傅里叶变换（这一点我记不住），傅里叶变换的时移性质。

    今天回过头一看，这不是个ARMA（1,1）的模型么，上下取模平方乘输入功率谱密度即可求解功率谱密度表达式，问题在于这一对傅里叶变换。后面证明需要大脑清醒，实在不行也可以怼出来，反正复习的时候我证出来过。

2. 丢了一问。首先对a进行特殊值赋值，然后证明。快速证明时直接取模运算，小于等于积分内部取模，小于等于证明目标即可。

3. 二重求和看作是矩阵的所有元素求和。

4. 截断ACS并不有效，截断相当于矩形加窗，在另一个域中就是sinc函数，显然是不对的。此处可以直接带入一种简单的情况进行判断。

5. 证明要注意两边互相推出来，假设功率谱全是正数，可以将上式进行二次型整理得到积分式，结果也是大于0的；假设上式结果是正确的，则需要反证法。这个证明方法我不喜欢，有时间回来看看有什么好方法不。

    我看完回来了，证明思路是，通过傅里叶变换的特点证明，当m足够大的时候相当于冲激函数（当一个域内无限长的时候，另一个域中就会充分短，我们假设a在时域中无限长且保持一定的值，则频域中就相当于是一个冲激函数），这在积分的时候就会保留功率谱本身的取值，因此对于充分大的m而言，积分结果取决于功率谱密度本身的值，如果这个值为复数，那么最终积分出来的结果也是负的。这么看的话结果就明显了。

6. 信号是叠加的不代表功率谱也是叠加的，而是需要计算相关函数然后做变换得到。注意冲激函数的处理。

#### 第二章

1. ACS估计方差。方差计算，平方的均值减去均值的平方。结果整理整理还是可以得到的。高斯过程四阶矩。这里还有一个**二阶求和**，套用第一章结果即可。注意**协方差的计算公式**，乘积的期望减去期望的乘积。
2.  证明的时候用无穷区间比较容易。这里使用无穷区间有一个条件，这个在考试题中详细说明了。表达式得记住啊。
3. 证明已有结论，正着推反着推是一样的。其实这里的证明可以正着推一遍，也可以反着直接带入。复习的时候算出来过，考试记得自己怼一怼。
4. 这个最大似然估计就是选择一个合适的取值让原似然函数的取值最大。

#### 第三章

1. `Yule Walker`方程的推导。正着推需要会。正着推是使用AR模型，利用传递函数的特点和相关函数的特点将结果写成矩阵的形式，然后根据矩阵的特点将结果写成两式之和为0的形式。逆映射问题，需要将$$r_x$$向量单独分离出来，此时将写成$$A_1r_x+A_2r_x^*=\left[\begin{matrix}\sigma^2 \\ 0\end{matrix}\right]$$的形式，此时如果将两者都进行虚部实部的分解并写成矩阵的形式，结果将是可以计算逆映射的。当然这里只针对了AR部分，对于MA部分的结果就需要再进行一次计算。计算相关不能忘了共轭。

2. 题目让我们将方差与相关序列建立联系。分别计算。这有个**正交原理**我没找到在哪里（补充，在3.3中证明，预测误差是白噪声，给出的e就是预测误差，预测值一减就出来了），但是自适应滤波器有讲过类似的。有了正交原理最后就很容易得到结果。

    第二问是双边指数衰减，带入就可以验证，$$r(k)=\alpha^{\mid k\mid}$$；第二问第二部分可以设置为偶数$$r(k)=\alpha^{\mid k/2\mid}$$。第三问，由于单向滤波器是双向预测的子集，因此认为方差会全集小。

    **认真做了一遍这个题，这个题答案就是一坨屎，分析不清楚，结论没证明，指代不明，如果出这个题我只好不做了。**

3. 第一个证明部分，其实可以考虑将功率谱拆成不含分母的两部分，然后通过同时反变换的方式推知，AR的相关矩阵一样满足Y-W方程，因此也是满足条件的结果。

    后面关于相关性质的证明真的是十分有趣。证明过程很厉害，有三年前我上高中时候的感觉。

    第三步的证明在上一步应用不等式的时候就已经证出来了（取等条件）

    最后的证明凑了一步，其实也很巧妙。如果考试考这个题就很舒服了，道理清晰，证明难度适中。

4. 这里的反射系数是相关矩阵的增广形式的行列式与本身的行列式的比值。行列式求值递推很简单，证明不难。证明方程的解可以直接带入，直接解很麻烦感觉，应该可以用特征方程法。

5. 答案说相关函数的估计方法不同，他说是，那就是。我实在也没整明白到底哪里不一样了。

    经过我对答案的仔细分析，答案应该是说，两者对于相关函数的估计不同。书中的估计是标准有偏或无偏ACS，而此处的估计是协方差估计。

    在国家对网络的封锁中，我终于发现了端倪。原来说使用A(z)的估计对y滤波得到f，和直接相乘居然不一样？以我个人的理解，两者的不同点在于，书上的方法是从中心开始的估计，而这里的估计是从n+1点之后的估计，但是在较大的N下，n+1这种级别的数字将会被稀释，因此在N巨大的条件下，这个结果是相似的。

6. 这题答案那么老长，一会回来看看吧先睡会。首先将相关函数从中间分开，左右各一半，共轭对称。功率谱是相关函数的傅里叶变换（两侧的单边变换），这样也可以获得单边功率谱。根据相关函数的分边方法，可以将功率谱也分为两侧共轭对称的根据题目的介绍，C就是单边功率谱与A的乘积，题目分为共轭的两部分结果，则两部分结果求和就是C和C*。可以将分子用a和c表示，最后表示成d的函数。可以证明d可以表示为aRa的二次型形式（我觉得这里是在胡说八道但我没有证据）

    这个题应该是一个必考题，我再来捋一遍思路。首先证明原式可以写成给出的形式，显然是可以的，如果我们将功率谱密度拆成两个，分别是两个单边的相关函数变换得到，那么可以定义单边功率谱与A乘积构成C。这样恰好可以将原3.10.8表示出来。

    此时需要证明C是唯一的。答案对这一部分证明较为傻逼。由于C的定义是唯一的，而且不能找到第二种分解方法使得原功率谱可以分成如本题所示的形式。因此C就是唯一的。将c表示出来很简单。

    接下来证明这种方法与书中所示方法等价。将前面的两个半个的功率谱加在一起，分子是CA+AC的形式。我们将分子写成D，可以写出d由ac组合而成的序列。由于ac之间还存在一个卷积相关函数的关系，因此可以将结果写成a和r两组数据组合的形式。写成矩阵我们将得到与课本相似的形式。

    这里证明有一些细节很好，例如为了后面代换c的时候形式简单，前面将特殊下标加在a下面。这里的取值范围也显得极为重要。

#### 第四章

1. 这个题就是把延迟带进去就解出来了
2. 将原来的概率密度函数做傅里叶展开，求出来-1对应的那个级数为0就可以（或者alpha的均值为0）。
3. 第三题，首先根据y的表达式写出y的相关矩阵表达式，然后写出相关序列的表达式，根据表达式写出参数a的估计。这里求逆需要用到一个矩阵求逆法则。
4. 下一个题真不会，考到自杀。

## Multiple Emitter Location and Signal Parameter Estimation

这个是提供给我们的必读文献之一。1986年的古董。**还没完全看懂先把前面的部分翻译了**。

`2019-4-4 21:22:06`希望这几天先把前面的摘要看明白。这个稿子修修改改就是最后讲的稿子了。

`2019-4-7 16:37:05`我已经是第五次看这篇论文了，实际上还是没看明白一部分算法。

首先这个算法被称为是`MUSIC`算法，其得名是**Mu**ltiple **Si**gnal **C**lassification。不得不说外国人还是很会起名的。这个算法的背景如下所述

在许多实际的信号处理问题中，我们的目标往往是根据测量结果估计接收信号所依赖的一组常数参数（这个应该说是参数化估计的目标）。为了解决估计问题，目前已经有一些成熟的算法，例如最大似然算法、`Burg`算法以及最大熵方法。虽然这些方法已经成功应用，但是它们有一些限制与不足，尤其是在参数估计中的偏差问题与灵敏度（分辨率）等问题。这主要是因为它们采用的模型并不完全正确，例如应该是用`ARMA`模型的地方为了各种原因而选择了`AR`模型。后面有人开发了利用数据的结构来进行估计的方法，例如使用协方差方法估计加性噪声中复杂正弦信号的参数。本文作者是第一个独立在任意形式的传感器阵列情况下正确利用了模型的人。他首先在没有噪声的条件下得到了完整的几何解，然后巧妙地扩展几何的概念在存在噪声的情况下获得合理的近似解来完成估计。这个算法就是`MUSIC`算法，至今为止已经被广泛研究。在目前公认的高分辨率算法中，`MUSIC`算法或许是最有前景的一种算法。不过虽然这个算法性能水平优异，但是却要占用大量的运算与存储资源。

简单地说，`MUSIC`算法采用的是本征空间方法估计信号或自相关矩阵的频域内容。对于一个指定阶数$$M$$的自相关矩阵的方阵，我们将特征值按从大到小排列，那么最大的$$p$$个特征值对应的特征向量应当是我们需要的信号，属于信号子空间；而对于剩余的$$M-p$$个特征向量，就是上一个空间的正交子空间，我们认为这里只有噪声。下面我们**复读一下论文的内容**。

> 阅读此文章需要一定的线性代数知识基础，大一我们学的线性代数实在是有些naive，读这篇文章根本读不懂。

### Abstract

处理传感器阵列接收的发射机信号在很多估计用途中都十分重要，也被广泛关注了。一般的问题都是考虑在任意协方差矩阵的噪声/干扰环境中有任意位置和任意方向特性的的传感器，本文则是首先考虑了多个发射机的该类问题，然后考虑了这种问题的通用解。这里提出的算法是`MUSIC, multiple signal classification`算法提供了以下参数的渐近无偏估计方法

- 入射波前数的。*波阵面是波在介质中传播的时候，经历相同时间所达到的各点所连成的直线、曲线或曲面，最前面的那一个面被称为波前。这里强调波前可能是因为考虑到了波阵面上相位相同*
- 发射机位置。
- 波形的强度和不同波形之间的互相关。
- 噪声、干扰强度。

此处对比了最大似然估计方法以及最大熵法，以及一些其他的实例，会在后面介绍。

### Intro

术语`MUSIC`用于描述涉及根据在阵列元件处接收的信号进行的测量来确定作为天线阵列到达的多个波前的参数所涉及的实验和理论技术。

> MUSIC就是一种根据测量到的接收信号确定天线阵列到达的多个波的参数的技术，可以用于理论分析也可以用于实践指导。

一般的问题涉及天线，这些天线可以有任意位置与任意方向特征且在含噪（或干扰）环境下有着任意的协方差矩阵。按照上面的描述，`MUSIC`算法可以提供下列参数的渐近无偏估计

- 信号数量
- 信号方向
- 不同方向波形的强度及其互相关
- 极化
- 干扰或噪声的强度

这个方法十分普适，典型应用有

- 传统干涉测量法
- 单脉冲方向搜索
- 多频率估计

> 这一段英语说得太拧巴了，用白话说一遍下面这段
>
> `MUSIC`这个词是一种算法的缩写，这种算法是用来进行信号处理的，具体是对于阵列接收到的波前信息进行处理的，主要用于接收参数估计信号谱的。
>
> 一般问题都是考虑一个任意位置任意方向性（方向性指增益、相位与极化等）的天线系统，这个系统是在一个有干扰和噪声的环境中的，并且有任意的协方差矩阵（协方差矩阵往往是提供功率与相关性等信息）。这个算法也是在这种假设下进行的，它可以提供如下的估计
>
> 1. 信号数量
> 2. 信号方向
> 3. 不同方向波形信号强度和协方差矩阵
> 4. 极化
> 5. 干扰和噪声强度
>
> `MUSIC`算法的一些典型应用场景是
>
> 1. 传统干涉测量
> 2. 单脉冲测向（DF），例如采用多共置天线
> 3. 多频率估计



### Data Model

`M`个阵列单元接收到的波形是由`D`个事件波前以及噪声线性组合而成的。因此我们认为结构可以描述为
$$
\begin{equation}
\begin{split}
\left[ \begin{matrix}X_1\\X_2\\...\\...\\X_M\end{matrix} \right]=\left[ \begin{matrix} \\ \\ a(\theta_1) & a(\theta_2)&...&a(\theta_D)\\ \\ \\ \end{matrix} \right]\left[ \begin{matrix}F_1\\F_2\\...\\...\\F_D\end{matrix} \right]+\left[ \begin{matrix}W_1\\W_2\\...\\...\\W_M\end{matrix} \right]
\end{split}
\tag{2.1}
\end{equation}
$$


或者可以简写为
$$
\begin{equation}
\begin{split}
&X&=&A&F+&W\\ RP: \\
&X(t)&=&A(\theta)&F(t)+&W(t)
\end{split}
\tag{2.2}
\end{equation}
$$
> 这个人用的符号好奇怪啊
>
> 这里表示的意思就是，我们有$$M$$个阵元，接收到了$$M$$个信号$$\boldsymbol X$$，这些测量到的值可以表示为上述形式，$$A$$是导向矩阵，$$F$$是信号源（参考点）的信号，$$W$$用来表示噪声（噪声是所有噪声源的等效噪声，例如测量噪声、信道噪声、设备内部噪声等）。注意以上的所有矩阵都是复数矩阵，这样更有代表性。
>
> 矩阵$$A$$中的元素可以表示为$$a_{ij}$$，是信号抵达角和阵元位置的函数。我们有$$D$$个信号从参考点发出，这个数量要小于$$M$$个阵元的数量，此时$$A$$矩阵也有$$D$$列，$$M$$行。$$A$$从物理意义角度来看，其每一行$$a_i$$取决于阵元 $$i$$，位置相对原点，每一列代表对$$j$$个信号入射方向入射的信号的响应。所以结果就相当于每一个阵元对每一个信号的测量结果的加权。
>
> $$A$$矩阵的第$$j$$列是一个模式向量$$a(\theta_j)$$，是对第$$j$$个信号到达角$$\theta_j$$的响应。知道了模式向量$$a(\theta_1)$$就相当于知道了$$\theta_1$$。（这里要求$$\theta_1$$和$$a(\theta_1)$$是一一对应的函数关系）

在几何语言中，可以将测量的$$X$$矢量可视化为$$M$$维空间中的矢量。这样$$A$$实际上是一个变换矩阵，将参考点信号映射到了测量点的值，这样就可以简单可视化这个结果。第一个等式说明$$\boldsymbol X$$是模式矢量的特定线性组合，$$F$$中的元素就是组合的系数。注意，$$\boldsymbol X$$是被限制在$$A$$的范围空间内的。如果$$A$$有两列，则$$\boldsymbol X$$就必然位于$$M$$维空间内的二维子空间内。另一点需要注意的是，$$a(\theta)$$是一个连续函数，在$$M$$维空间内，但是是非常非线性的。如果想要尝试理解这个可视化原理，我们可以参考这张图

<div style="text-align:center"><img alt="" src="https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/MUSICFig1.png" style="display: inline-block;" width="600"/>
</div>

> 这张图给出的是三天线的场景，三天线系统中，我们测量到的三个信号就是$$X_1,X_2,X_3$$，在途中也有这三个信号，分别为三条虚线。
>
> 其中$$e$$向量分别是对应于特征值$$\lambda$$的特征向量，对于较大特征值，对应的特征向量就张成了信号子空间（如图所示的二维空间），对于较小的特征值，对应的就是噪声子空间（如图所示的一维向量）。从图中可以直观看出来，信号子空间与噪声子空间是相互正交的，这只是人类能够接受的最高维的情况的，对于更为高级的维度，就不能在这里可视化展示了。我们接下来需要做的就是证明这个理论的正确性。
>
> 图中还有俩向量在信号子空间内，这两个正是信号的模式向量。下面会证明这个模式向量是与噪声子空间正交的。


三个以$$e$$命名的向量分别是信号与噪声的归一化**特征向量**。此时我们的假设是，在仅方位角测向系统中，$$\theta$$将是单一参数构成的（也就是方向角）。当然如果在一个方向角、仰角、距离系统中，这个$$\theta$$就由这三个参数构成。无论在什么情况下，$$a(\theta)$$都是一个连续型矢量函数，扭曲缠绕在$$M$$维空间中。

在这些几何术语中，解决多个入射波前的到达方向的问题包括定位$$a(\theta)$$连续矢量函数与距离空间$$A$$相交点。

$$A$$的距离空间是从测试数据中获得的。接下来是获取这个距离空间及其维度的方法。

其实这里的`range space`一词还不知道具体指什么。

### The S Matrix

也不知道是谁引入的这种叫法，实际上就是相关矩阵。
$$
\begin{equation}
\begin{split}
S=\overline{XX^*}=A\overline{FF^*}A^*+\overline{WW^*}
\end{split}
\tag{2.3}
\end{equation}
$$
或者说我们写作
$$
\begin{equation}
\begin{split}
S=APA^*+\lambda S_0
\end{split}
\tag{2.4}
\end{equation}
$$

> 至于为啥这么写我们下面慢慢看

我们的基础假设是，参考源发出的信号与噪声信号是不相关的。注意信号的波前矩阵$$F$$中的元素（即波前）可能是相互之间不相关或者完全相关的（这时候矩阵$$P$$就是一个奇异矩阵）。总的来说，$$P$$矩阵应该是正定的，反映了入射波形之间成对相关的程度（相关性，不相关就是$$0$$，相关就是大于$$0$$）。

> 奇异矩阵，非满秩矩阵。这是一个针对方阵的说法。奇异矩阵行列式为$$0$$

当不同波前的数量$$D$$少于阵元数$$M$$的时候，$$APA^*$$是奇异矩阵。它的秩不满，那么就有行列式为$$0$$。根据$$(2.4)$$的等式关系，我们可以得到$$\mid S-\lambda S_0 \mid = 0$$这样的结论。这个结论的条件是，$$\lambda$$等于$$S_0$$的度量中$$S$$的一个特征值。类比一下$$\mid S-\lambda I\mid=0$$的条件是$$\lambda$$等于$$I$$的度量中$$S$$的一个特征值。不过在$$A$$满秩且$$P$$正定的条件下，$$APA^*$$一定是非负定的，因此这个式子成立的条件只能是$$\lambda=\lambda_{min}$$。
$$
\begin{equation}
\begin{split}
S=APA^*+\lambda_{min} S_0\:,\:\lambda_{min}\geq 0
\end{split}
\tag{2.5}
\end{equation}
$$
注释一下，$$\lambda_{min}$$是$$\mid S-\lambda S_0 \mid = 0$$的最小值解。以上都是针对特殊情况的，如果噪声向量均为零均值，$$\sigma^2$$方差的，那么$$\lambda_{min}S_0=\sigma^2 I$$。

### Calculating a Solution

上面乱七八糟说了很多，坑也开了很多，现在我们来求解。

$$APA^*$$的秩为$$D$$，可以从$$S$$在$$S_0$$度量下的特征值中直接确定。在理想情况下，我们认为特征值有功率的含义，此时噪声功率倘若都认为是相同，那么最小特征值将被认为是噪声的特征值。如果我们发现最小特征式重复了$$N$$次，那么对信号数量的估计就是
$$
\begin{equation}
\begin{split}
\hat D=M-\hat N
\end{split}
\tag{2.6}
\end{equation}
$$
由于在我们的假设中，信号的数量是不超过阵元的数量的，那么分解以后的$$APA^*$$只代表信号部分，此时最小特征值一定为$$0$$。而分解出去的噪声部分，一定是补全这一部分的。这里说的$$\hat N$$就是$$\lambda_{min}$$的重复次数。（不过从实际操作的角度来讲，这个值的出现一定不是一个固定值，而是若干个不同的值，在某一个范围内分布，毕竟估计值与理论值相比有一定误差）

### The Signal and Noise Subspaces

信号与噪声子空间。这一段开始胡说八道。

$$S$$在$$S_0$$度量下的$$M$$个特征向量一定满足$$Se_i=\lambda_i S_0 e_i$$这个关系，其中$$e_i$$就是特征向量。

>这个说法源头是线性代数中的一种简化表达
>
>$$Ax=\lambda x$$
>
>此时$$\lambda$$是特征值，$$x$$是对应的特征向量，可以组成列向量矩阵。
>
>这里修改了度量，将原来的$$I$$度量修改为了$$S_0$$度量，是为了应对特殊情况。对于简单的白噪声情况，仍然是以$$I$$为度量。

那么将这个关系带入到上面的表达式中我们会得到$$APA^* e_i=(\lambda_i-\lambda_{min})S_0 e_i$$。显然当任意一个$$\lambda_i$$取值为$$\lambda_{min}$$的时候，上式右侧就是$$0$$。如果考虑到$$P$$是个正定的矩阵，那么只能得到$$A^*e_i=0$$

还记得$$A$$矩阵是导向矩阵，是由阵元特性决定的。这个结果说明了$$\lambda_{min}$$所关联的特征向量与空间导向矩阵$$A$$的列向量是相互正交的。作者在这里给画了一个叹号，以示发现惊人

<div style="text-align:center"><img alt="" src="https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/MUSICFig.png" style="display: inline-block;" width="500"/>
</div>
那么因此我们可以合理地将$$N$$个噪声特征向量跨越的$$N$$维子空间称为噪声子空间，并将由入射信号模式向量跨越的$$D$$维子空间称为信号子空间，他们是正交的。

> 咱们回来理一下，为什么这个地方作者会用叹号来说。到目前为止作者都在推导一个是，那就是信号子空间和噪声子空间的正交性问题，如果符合这一点，那么就可以继续采用下面的算法进行计算了。首先确定什么是信号子空间，什么是噪声子空间。结合上面的图片我们可以看到，子空间是通过特征向量来定义的，这里我们看一下同济大学线性代数的资料。
>
> 线性空间的含义如下。
>
> 线性空间也叫向量空间，是线性代数的中心内容之一。线性空间是可以人为定义的，只要满足了特定要求，都可以被称为是线性空间，具体需要满足的关系可以查线性代数的课本（实际上是加法与乘法）。满足了这个运算关系的集合就可以被称为是一个线性空间，对于这个集合的一个子集，如果上述运算关系也都满足，且封闭，并且包含零向量，那么就说这个子集是原线性空间的子空间。
>
> 那么子空间应当是原空间中自洽的一个闭合空间。子空间有几个运算需要解释
>
> 对于一个向量集合，包含它的最小子空间就成为这一组向量的**扩张**，记作$$span(B)$$
>
> 对于上述向量集合，如果他的扩张是向量空间$$V$$，那么原向量集合就被称为是**生成集合**
>
> 对于上述向量集合，如果是线性无关的，且可以生成$$V$$，那么他就是$$V$$的一个基
>
> 然后我们来找找文章中的信号子空间。
>
> 信号子空间就是大特征值对应的特征向量张成的子空间，而噪声子空间就是若干较小特征值张成的子空间。通过上述证明我们已经发现，这两个子空间是相互垂直的。
>
> 作者到这里的时候显然完成了本文中最重要的证明之一，故采用叹号进行说明。

### The Algorithm

我们现在就有办法解决信号模式向量的问题了。如果$$E_N$$定义为$$M\times N$$的向量，$$N$$列分别为噪声特征向量，那么任意一个向量$$Y$$到这个空间的欧几里得距离（的平方）可以定义为$$d^2=Y^*E_NE_N^*Y$$，那么我们可以认为
$$
\begin{equation}
\begin{split}
P_{MUSIC}(\theta)=\frac{1}{a^*(\theta)E_NE_N^*a(\theta)}
\end{split}
\tag{2.7}
\end{equation}
$$

可以看出，即使是对于多个入射信号而言，`MUSIC`的估计也是渐近无偏的，因为$$S$$矩阵是渐近完美地测量，因此从此得出的$$E_N$$也是。$$a(\theta)$$则不依赖于任何测量数据。

一旦`D`个入射信号的方向角被找到了，$$A$$矩阵就是可用的并且可以用来计算各个信号的参数了。$$P$$矩阵的解析解可以表示为
$$
\begin{equation}
\begin{split}
P=(A^*A)^{-1}A^*(S-\lambda_{min}S_0)A(A^*A)^{-1}
\end{split}
\tag{2.8}
\end{equation}
$$

> 一般意义上的MUSIC算法到这里就应该是结束了，但是这里从论文的角度来看还有半篇，本次课题也是读论文为主，因此我们计划把整篇论文都整完。

### Including Polarization

极化问题，这里我就不是很懂了。上面说到，此时我们已经知道了$$A$$矩阵，可以用这个矩阵来估计信号的参数了。实际上我觉得可以翻译成偏振问题。

那么考虑一个信号，它从一个特定方向$$\theta_0$$来。假定阵元的极化相同，例如都是垂直极化。显然方向定位系统是对垂直极化能量最为敏感，而对水平极化的能量完全不敏感，对其他极化的垂直分量较为敏感。

对于一般阵列（即极化方向不同的阵列），对应于方向$$\theta_0$$的模式矢量取决于信号的极化。垂直极化信号将引起一种模式矢量，但是水平极化会引发另一种，右手圆极化也是另一种。

信号的极化可以被一个复数$$q$$来表示。我们可以观测当信号的极化参数$$q$$改变的时候（发射机方位角改变的时候），模式向量如何发生改变。可以证明，当极化参数$$q$$遍历了所有变化之后，模式矢量会扫出一个二维的极化子空间。因此仅需要两个独立的模式向量张成极化子空间就能表示$$\theta_0$$位置信号的任意极化方式了。实际的体现是，仅需要计算或保持两个发射极偏振的模式矢量以存储方向θ，以便求解发射极化，其中在具有非极化多样化的阵列的系统中仅需要一个来解决DOA。

这些论证导致类似于$$(2.7)$$的$$P(\theta)$$表达式，不过这个表达式里面需要考虑不同阵元的极化影响。

$$
\begin{equation}
\begin{split}
P_{MUSIC}(\theta)=\frac{1}{\lambda_{min}\left(\left[\begin{matrix} a_x^*(\theta)\\a_y^*(\theta) \end{matrix}\right]E_NE_N^*\left[\begin{matrix} a_x(\theta)&a_y(\theta) \end{matrix}\right]\right)}
\end{split}
\tag{2.9}
\end{equation}
$$
其中ax（θ）和ay（θ）是对应于例如分别取x和y线性入射波前偏振的两个连续函数。对应于（8）中的λ_min的特征向量提供极化参数q，因为它具有$$\left[\begin{matrix}1&q\end{matrix}\right]^T$$的形式。

<div style="text-align:center"><img alt="" src="https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/MUSICFig2.png" style="display: inline-block;" width="500"/>
</div>



### The Algorithm

总而言之，上图所示的算法可以总结为

0. 收集信息，用测量（快拍）结果构建$$S$$矩阵。
1. 在$$S_0$$的度量下计算$$S$$的特征结构
2. 估计决定信号数量$$\hat D$$
3. 计算$$P_{MUSIC}$$，上述两个公式都是可以的
4. 选出前$$D$$个谱峰
5. 计算剩余参数

上述步骤已经通过多种方法实施过，用来验证方法和评估基本性能。已经使用真正的接收机、阵列天线和多发射机进行了现场测试，这些测试都证明了这种方法在信号处理上的潜力，性能测试将在另一篇论文中进行发表。

### Comparison with Other Methods

对比一下其他算法，其他方法包括普通波束成型法、最大似然法和最大熵法，表达式如下
$$
\begin{equation}
\begin{split}
P_{BF}(\theta)&=a^*(\theta)S a(\theta)\\
P_{ML}(\theta)&=\frac{1}{a^*(\theta)S^{-1}a(\theta)}\\
P_{ME}(\theta)&=\frac{1}{a^*(\theta)cc^*a(\theta)}
\end{split}
\tag{2.10}
\end{equation}
$$
如上所述，$$c$$是$$S^{-1}$$的列。波束成形器的算法是计算波束成形器的输出位置的功率在方向上的函数。最大似然法计算的是对数似然函数，其中假设$$X$$是零均值的多元高斯分布，只存在单个入射波前。对于多入射结果，应改为
$$
\begin{equation}
\begin{split}
P_{ML}(\theta)=\frac{1}{\lambda_{min}\:a^*(\theta)S^{-1}a(\theta)}
\end{split}
\tag{2.11}
\end{equation}
$$
最大熵法的本质是基于选择一个阵元作为参考阵元，试图去找到一个合适的权重应用到剩余的$$M-1$$个阵元结果上，试图用`MMSE`方法让结果去尽可能接近参考点。因为有$$M$$种可能的参考方式，因此可以产生$$M$$种图线，这里只选了一种。

对于以上结果，请参见下图

<div style="text-align:center"><img alt="" src="https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/MUSICFig3.png" style="display: inline-block;" width="500"/>
</div>

<div style="text-align:center"><img alt="" src="https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/MUSICFig4.png" style="display: inline-block;" width="500"/>
</div>

第一个图是仅进行方向角判断时的结果，第二个图是将$$30^\circ$$的次强信号的三种方法结果放大。

<div style="text-align:center"><img alt="" src="https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/MUSICFig5.png" style="display: inline-block;" width="500"/>
</div>

上图是一个完整采用`MUSIC`方法的实例，应用于多馈源抛物面碟形天线的转向问题。这里原文提到了`pencil beamshape`，经过我的检索得到，这其实是描述波束成形后为强指向性的一种波束，原文前面还加了$$\frac{\sin x}{x}$$修饰，即强指向性是采用`sinc`成型的。此处是假定这个指向略微偏离准线，但仍然是强指向的。由于六个天线基本上是共同定位的，波束模式变化可以导致方向搜索容量增加。计算机来模拟含噪的`S`矩阵。让这个矩阵经过`MUSIC`算法，我们就看到了如图所示的结果。图是信号的方向估计、极化方向估计和互相关。可以看出即使信号的相关系数达到了$$90\%$$，结果也能较为正确地分辨。

<div style="text-align:center"><img alt="" src="https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/MUSICFig6.png" style="display: inline-block;" width="500"/>
</div>

上图展示了`MUSIC`算法在非常有限的持续时间数据样本中估计多个正弦波（任意相位和幅度）的频率应用。这个图表明即使没有包含实际噪声，将数据样本舍入之后会破坏原有的大部分信息。因此`MUSIC`在使用过程中占用较多的存储资源问题目前优化还存在问题。

### Summary and Conclusion

很多人在类似方法的探索上都出了自己的一份力，这里不一一表扬或批评。有的人是只关心于矩阵对应的线性方程的解，忽略了矩阵本身存在的特征结构是一个解决问题的更快的思路。虽然有人向这个方向靠近了，但是却没有采用子空间的方法进行解释，这样仍然会让问题复杂化一些。相同的概念也被用于过时间序列谱分析法，即我们熟悉的`Karhunen-Loeve`变换法。

与上述方法不同的是，这里提出的`MUSIC`算法在多信号分析分类问题上有很好的普遍性，可以从空间几何形状的角度来进行合理而快速的解释，这都得益于对`S`矩阵的特征结构的测量分析。另外`MUSIC`算法提供的估计精度十分接近`Cramer-Rao`精度界限的一般信号参数集的渐近无偏估计。该算法将数据建模为点源发射与噪声的总和，而不是由白噪声激励传递函数等这样的时间序列模型，也是该算法存在优势的一个原因。我们学习的谱估计算法看起来已经十分先进，但是相比之下`1986`年的论文就已经在研究比这些算法更为有效的算法了，可见我们的学习是多么的滞后，我国计数发展水平也可见一斑。

`2019-4-7 14:55:17`

