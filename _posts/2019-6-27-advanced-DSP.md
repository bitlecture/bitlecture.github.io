---
layout: single
title:  "高级DSP复习"
excerpt: "高级DSP复习"
date:   2019-6-27 14:18:55 +0000
categories: Notes
tags: 
  - "高级DSP"
comments: true
header:
toc: true
toc_label: "My Table of Contents"
toc_icon: "cog"
author: Shi Nian
---

<!-- mermaid绘图 -->
<script src="http://anaqq.xyz/blog/assets/js/mermaid.min.js"></script>
<script>mermaid.initialize({startOnLoad:true});</script>


## 第一章 基础知识

### 信号、信息、数字信号处理

- 信号：反映或载有信息的物理量（光信号、电信号）

- 信息：信号的具体内容（信号代表什么意思）

> **什么是数字信号：时间和幅度均离散。**模拟信号指时间和幅度均连续。所以不是数字信号的一个信号不一定是模拟信号。

> **什么是数字信号处理：**利用计算机或专用处理设备，以数值计算的方法**对信号进**行采集、变换、综合、估值和识别等加工处理，借以达到**提取信息**和便于应用的目的。数字信号处理（按照过程来分）一般包括去噪、特征检测和应用于实际这三个方面。

## 第二章 离散时间信号

### 脉冲串序列

单位抽样信号$\delta(n)$ $\rightarrow$脉冲串序列$p(n)=\sum_{k=-\infty}^{\infty}\delta(n-k)$

### 离散信号的基本运算

- 延迟

- +、-、*（需要有相同的长度和时间范围）

- 时间尺度变换
  
  - $y(t)=x(t/2)$ : 扩展，原来的$x(1)$相当于现在的$y(2)$，相当于对原信号进行插值，采样频率变为$2f_s$
  
  - $y(t)=x(2t)$ : 压缩，原来的$x(2)$相当于现在的$y(1)$，相当于对信号进行抽取，采样频率变为$f_s/2$

- 信号的分解
  
  *信号在向量空间中向不同基向量进行投影。确定基函数+投影求系数（e.g. FFT）=信号分解*

- 信号的变换
  
  *确定基函数后求分解系数的过程（e.g. FFT、DCT）*

### 信号的分类

#### 确定信号、随机信号

<div class="mermaid">
graph LR;
  A[信号] --> B[确定信号];
  A --> C[随机信号];
  B --> H[周期信号];
  B --> I[非周期信号];
  C --> D[非平稳];
  C --> E[平稳];
  E --> F[各态遍历];
  E --> G[非各态遍历];
</div>

> 平稳随机信号：统计性质不随着时间改变
> 
> 遍历：随机过程的各个样本函数经历了随机过程的各种可能状态

#### 维度区分

- 一维信号

- 二维信号

- 多通道信号
  
  *e.g. （R，G，B）*

### 范数

<p>$||x||_p=\left[\int_{-\infty}^{\infty}|x(t)|^pdt\right]^{1/p}$</p>

*每一类范数定义了一个信号空间（$l_p$）*

> 赋范线性空间：定义范数的线性空间
> 
> 线性空间：$l_\infty, l_1, l_2$都是线性空间
> 
> 度量空间：定义了距离的空间（$l_2$）
> 
> 内积空间
> 
> 希尔伯特空间：完备的内积空间

## 第三章 离散时间信号的傅里叶变换

### 傅里叶级数

傅里叶级数实际上是先找一组基向量$\\{e^{-jk\Omega_0t}\\}_{k=1}^{N}$，然后将信号在这组向量上投影（做内积）得到傅里叶系数，实际上傅里叶系数对应着第$k$次谐波的系数，所以一般频域时离散的，间隔为$\Omega_0$。如果要求傅里叶系数，根绝内积空间基向量的定义（正交），左右两边同时积分然后除以一个常数（基向量自己做内积得到的值）即可得到系数。

<div class="mermaid">
graph LR;
A[周期] --> B[离散];
C[非周期] --> D[连续];
</div>

### 傅里叶变换

| 傅里叶级数                      | 傅里叶变换              |
|:--------------------------:|:------------------:|
| $X(k\Omega_0)$表示第k次谐波幅度的大小 | $X(j\Omega)$表示频谱密度 |
| 周期信号/功率信号                  | 非周期信号/能量信号         |

> 从量纲上来看，$X(j\Omega)$等于谐波幅度$X(k\Omega_0)$除以频率$\Omega_0$（乘以周期T），所以$X(j\Omega)$是频谱密度的概念。

### Parseval定理

看做是在不同空间的投影，原信号（向量）不变。

### 截短（加窗）对信号频谱的影响

时域相乘，频域进行卷积，结果是主瓣（主瓣宽度$B=4\pi/N$）对原信号的频谱起到了平滑作用，降低了对原信号频谱中谱峰的分辨能力，一般要求$B>\|\omega_2-\omega_1\|$，此时可以分辨开两根谱线（两个正弦信号）。

> 频谱泄漏：由于旁瓣的存在，卷积后原本为0的位置不为0,这种现象称之为频谱泄漏，旁瓣越大，泄露越严重。

- 频率分辨率降低
  
  *增加窗函数长度（信号长度）可以提高频率分辨率*

- 频谱泄漏
  
  *由于旁瓣造成*

> 主瓣宽度和旁瓣幅度不可能同时减小。

### 抽样定理

![]({{site.url}}/assets/images/2019-6-27-advanced-DSP0.png)

对于一个**带宽有限**（这时才有最高频率$f_c$）的连续信号$x(t)$，在时域对其抽样，相当于在频域进行周期化（离散$\rightarrow$ 周期化），只要符合采样定理（即频域的周期$f_s$大于$2f_c$），就不会发生重叠，所以之后可以恢复成原信号。

### 信号的重建

只要满足抽样定理，由无穷多加权移位sinc函数的和即可重建出原信号。

> 对于正弦信号，抽样时，$f_s$应该是原信号频率$f_c$的3倍即以上。一般FFT要求是2的整数倍，所以可取4倍，即每周期4个点。

### 频率分辨率

#### 第一种定义

$\Delta f=1/T$，$T$是$x_T(t)$的长度，无限长信号$x(t)$加窗

这种定义下，要是增加频率分辨率就只有增加窗的长度，即增加信号长度。

**or**

$\Delta f=f_s/N=1/(NT_s)=1/T$，信号长度为$T$，取样周期为$T_s$，一个周期取$N$个点。

#### 第二种定义

$\Delta f=f_s/N$，DFT时频率轴上所能得到的最小频率间隔

可以通过提高采样率和在数据后面补零来增加序列长度$N$，但是不能提高物理频率分辨率，因为不能改变原模拟信号的频谱形状。

> DFT中的N指序列长度，可以通过补零增加序列长度，其分辨率指相邻谱线的间隔。
> 
> DTFT中的N指的是有效序列的长度，与T有关，其分辨率与窗函数主瓣宽度有关。
> 
> 频率分辨率：一是取决于信号的长度，而是取决于频谱分析的算法。

### 补零问题

- 不能提高频率分辨率，因为没有增加数据的**有效**长度

- 补零后方便计算，同时有利于辨认原信号频谱（的形状）

## 第四章 离散时间信号的采样率转换

> 为什么要进行采样率的转换？使信号在系统的阶段不发生失真（如采样率过低，信号频谱会发生混叠）
> 
> **采样前后信号的功率不发生变化**

### 下采样

#### 系统结构

<div class="mermaid">
graph LR;
  A[信号x] --> B[抗混叠滤波器];
  B --> C[M倍下采样];
  C --> D[输出y];
</div>

#### 实现过程

每隔M-1个点取一个数，如2倍下采样，输出为$x(0), x(2), x(4)\dots$

#### 分析

从频谱上来看，若以$f$为横坐标，因为采样周期增大，相当于采样速率$f_s$减少，因此相当于频谱的周期减小为原来的$f_s/M$（这就意味着下采样后的信号频谱可能会发生混叠，因此在下采样前就要根据下采样的倍数设计抗混叠滤波器，也就是低通滤波器$\omega_s=\pi/M$）；若以$\omega$为横坐标，采样率（下采样前为$f_s$，下采样后为$f_s/M$）对应着$2\pi$，所以结合之前说的，会有M倍扩展的现象。

### 上采样

#### 系统结构

<div class="mermaid">
graph LR;
  A[信号x] --> C[L倍上采样];
  C --> B[抗镜像滤波器];
  B --> D[输出y];
</div>

#### 实现过程

原信号中间每两个采样点之间插入$L-1$个零值。

#### 分析

分析过程基本同下采样，注意的是，当抗镜像滤波器采用带通滤波器，可以实现上变频。

> 分数倍采样率转换=上采样+下采样
> 
> 此时抗镜像滤波器可以和抗混叠滤波器合并
> 
> 多级系统实现采样率转换的目的是简化滤波器设计（降低阶数）

## 第五章 采样率转换中的数字滤波器设计

### 滤波器作用

1. 抽取滤波器：抑制混叠

2. 内插滤波器：消除镜像

### 六个恒等关系

### FIR 滤波器的多相结构

> FIR 滤波器与 IIR 滤波器最大的不同就是线性相位。线性相位在物理上的体现实质上就是不同频率的信号经过系统后各频率成分的延迟时间是一致的。

- 使用恒等关系，将滤波器和变采样率操作交换位置，使滤波器工作在低速率端，降低了对运算速度的要求，提高了实时性的实现可能程度。

- 同样，因为CIA杨速率的降低，滤波器的阶数可以分别降低为原来的$1/M\ or\ 1/L$

### IIR 滤波器的多相结构

> IIR 滤波器具有低复杂度的缺点，但典型的缺点是相位非线性以及对量化噪声敏感

> 半点滤波器和 CIC 滤波器都是为了减小计算量，提高实时性

### 半带滤波器

*半带滤波器在$[0, \pi)$关于点$(\pi/2, 1/2)$中心对称*

#### 时域

<p>$h(k)=\begin{cases}1, k=0\\0, k=\pm 2, \pm 4  \end{cases}$</p>

*偶数系数除了零点外均为 0 ，因此计算量减小一半*

#### 频域

$H(e^{j\omega})=1-H(e^{j(\pi-\omega)})$

$H(e^{j\pi/2})=0.5$

### CIC 滤波器

#### 时域

<p>$h(n)=\begin{cases}1, 0\le n \le D-1\\0, others \end{cases}$</p>

*计算时只有加法没有乘法，无需存储器存储滤波器系数，计算简便*

#### 频域

$H(z)=\frac{1-z^{-D}}{1-z^{-1}}$

### 补充

#### FIR 滤波器与 IIR 滤波器的区别

#### 双线性变换法和脉冲响应不变法的区别

## 第六章 小波变换

| FT     | $\delta$展开 | STFT                     | WT             |
|:------:|:----------:|:------------------------:|:--------------:|
| 频域角度分析 | 时域角度分析     | 时频角度分析                   | 时频角度分析         |
| \      | \          | 高频信号时间短，低频信号时间长，时间窗大小不可变 | 窗函数大小随着频率变化而变化 |

### 小波函数特点

- 定义域有限

- 直流分量为$0$

### 连续小波变换(CWT)

#### 基函数

$\psi_{a,b}(t)=a^{-1/2}\psi(\frac{t-b}{a}),a>0,b\in R$

> 尺度因子a越大，时间窗口越大，频域窗口越小，二者乘积（窗口面积）不变。恰好符合实际中信号高频持续时间短，低频持续时间长的特点。
> 由于母小波函数在频域的带通特性，其伸缩和平移就可以看作是一组带通滤波器。
> 
> 小波变换相当于把一个时间函数投影到二维的时间-尺度平面上，李玉提取函数的某些本质特征。

#### 性质

- 叠加性

- 时移不变性

- 微分

- 卷积

- Parseval定理

#### 常用基函数

- Morlet小波
  
  *时频都有很好的局部性*

- Marr小波
  
  *高斯函数的二阶导数，0处有二阶零点*

- 紧支集样条小波
  
  *类似于一个周期的正弦波*

### 离散小波变换(DWT)

> 离散小波，指 a, b 离散，而不是对函数（信号）$f(t)$离散化
> 
> 通常对 a 进行幂级数离散化（一般底数取 2 ，即$a=2^m$）。

#### 特点

- DWT 仍有冗余度

- DWT 不再满足时移不变性

#### 二进小波

需要注意的是，二进小波知识对尺度因子离散化，因此它仍具有时移不变性，但二进小波仍然是冗余的。

### 正交小波变换

> 中心思想：大尺度因子的信号信息包含在小尺度因子的信号信息中。可以将正交小波和 FFT 快速算法结合在一起思考。将其想象成是一个去冗余度的过程。

#### 基于 WT 的小波去噪

1. 将信号投影到小波域，即进行离散（why 离散？因为之后是对小波系数进行处理）小波变换。

2. 对小波系数进行阈值处理。
   
   - 硬阈值处理：系数超过阈值则不变，否则变为 0 
     
     *相当于是只去除只有噪声的小波系数，没有一视同仁，所以最终的信号会产生震荡*
   
   - 软阈值处理：系数超过阈值则减去阈值，否则变为 0
     
     *相当于是既去除只含噪声的小波系数，又去除同时含信号和噪声的小波系数中的噪声部分，所以处理后的信号会比较平滑*

3. 再将信号小波域投影到时间域，即进行逆小波变换。
