---
layout: post
title:  "高级DSP 修订"
excerpt: "Advanced Digital Signal Processing"
date:   2018-10-29 21:54:54 +0000
categories: Notes
comments: true
---

<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
这就是传说中的高级DSP么

**注意，以下所有内容都是考试要点。**

推荐参考资料

[1].[胡广书.数字信号处理导论.清华大学出版社.2005](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/15811735-胡广书.pdf)



# 高级DSP



## 高级DSP课程简介

可能会出现的基础内容涉及**信号、噪声、信号空间、相关函数、采样、DFT**等。

可能涉及到的进阶内容包括**采样率转换、采样率转换过程中的数字滤波器设计**。

可能会出现一点**小波变换**。

## 一、 概论

快考试了 冲鸭！

信号、信息和消息是三个不同的概念。信息是消息的载体，而信号是信息的表现形式。信号有很多表现形式，自然界中的声音、图像（光）、震动等都属于一种信号，而人类也会人为产生一些信号，例如雷达信号、通讯信号等。

信号是一种与物理过程联系紧密的量，可以使用数学来描述与分析。DSP就是研究信号处理的学科。我们可以利用具体的数学表达式将信号描述成一个用若干自变量描述的函数或序列。我们常说信号分为**模拟和数字信号**，其中模拟信号（Analog Signal）就是连续信号，特征是信号在任意指定时间可以是任意值；而数字信号是一种时间（自变量）和信号（因变量）都是离散的信号。但是此处我们做一个更加广泛的分类，即

**模拟信号**：时间幅度均为连续

**连续时间信号**：时间连续，幅度连续或离散

**离散时间信号**：时间离散，幅度连续或离散

**数字信号**：时间和幅度均为离散值

其中既不属于模拟信号又不属于数字信号的的其他信号也在其中。很多教材中都会使用**离散信号**表示**数字信号**，这种说法是没有问题的。

由于数字信号的一些不可替代的优势，目前已经很少有地方还在使用全模拟信号的通信。对于模拟信号，往往也会采用数字处理方法。数字信号的优势有

1. **抗干扰强，无噪声积累**。经过一级处理后的数字信号不会积累噪声，我们可以通过判决再生的手段，将信号的噪声抑制掉，因为数字信号往往取离散值。而模拟系统的噪声是积累的，经过一级处理后，信号中的噪声就会被放大，设备的噪声也会叠加在信号中。
2. **方便加密**。离散值便于处理，这就不需要过多介绍了。
3. **便于设备集成化微型化**。数字信号处理时，大部分都采用数字电路进行处理，而数字电路的集成规模已经相当大了，体积小功率低。
4. **便于构成通信网**。标准化数字传输。不同信号之间转换方便。

而由于使用计算机处理或其他数字处理方式时，信号往往需要经过采样后送入每一个处理单元中进行处理，目前的设备并不能较为方便地处理连续信号，而当信号数字化后处理变得方便的多，因此目前绝大多数信号已经采用数字处理。而对于模拟信号，常常就采用采样量化的方式转化为数字信号，经过数字处理后，使用ADC转换为模拟信号。

在处理时，如果不加特殊说明，基本上都是对电信号的处理。另外信号是包括实信号与复信号的，物理上可以采集并处理的信号基本都是实信号，但是基于数字模型基础上的信号，很多都是复信号。

说到数字信号处理，其含义是利用计算机或专用处理设备（例如可编程设备或不可编程的门电路阵列），用数学方法对信号进行采集、变换、综合、估值与识别等加工处理，从而达成提取和便于应用的目的。因此我们说，数字信号处理的任务就是，从信号中提取我们需要的信息，并将其用于实际。例如一个简单的心电监护仪，主要通过收集人的身体信号，然后对这些信号进行处理，获取心电波形。这类仪器中往往是含有CPU的，能实时显示和存储病人的心电波形。实际上仅仅是心电信号的处理都十分困难，人体的一点移动都会造成采集地各路信号发生变化，而人体还存在较为明显的肌电噪声等其他噪声，设备还有50Hz工频干扰，因此心电信号的处理实际上较为困难，其中涉及许多处理的知识。但总体来说，数字信号处理一般包括**降噪（去噪）、特征检测、应用于实际**三个方面。

数字信号处理可以追溯到17世纪，当时已经采用了有限差分、数值积分、插值等方法，虽然与现代DSP还有很多不同，但是已经有了雏形。进入20世纪后，由于电子计算机等设备的出现，信号处理逐渐发展，成为了一个独立的学科。一般认为，1965年FFT的出现是数字信号处理这个学科的新开端，其中包含**经典数字信号处理、统计数字信号处理 和 现代数字信号处理**三大部分。

**经典数字信号处理**

1. 离散信号和离散系统分析（系统的描述、单位抽样响应、转移函数、频率特性等）
2. Z变换、DFT、FFT等信号域的变换
3. FIR、IIR数字滤波器设计。

迄今为止学习的内容都是经典数字信号处理。

**统计数字信号处理**

统计数字信号处理的对象主要是随机信号。

后面这几个都是坑。

1. 随机信号描述，自相关函数估计，AR、MA、ARMA、PRONY等各种信号模型
2. 经典功率谱估计和现代功率谱估计
3. 维纳滤波和自适应滤波

**现代数字信号处理**

主要是非平稳信号的分析和处理

1. 时频联合分析
2. 滤波器组
3. 小波变换

*短期内还是不会接触到这些内容的。*

数字信号处理的实现主要是**软件实现**和**硬件实现**。软件实现时，我们常采用MATLAB等类似的软件包，而硬件实现时，往往采用特殊的处理芯片，或使用特定IC构成满足数字信号处理任务要求的系统。

## 二、 离散时间信号

### 1. 典型离散信号

$$f_s=\frac{1}{T_s}$$，其中$$f_s$$是采样频率。我们常用$$\omega=2\pi \frac{f}{f_s}$$来表示。

$$\omega$$也叫归一化的数字角频率，由于在采样定理的框架下，只有$$\frac{f_s}{2}$$之内的信号能被采样，因此$$\frac{f}{f_s}$$的范围是(-0.5,0.5)，整个$$\omega$$的值域范围为$$2\pi$$。我们也常常取(0,1)这部分，和(-0.5,0.5)相同的是，各自只有一半有效内容，另一半都是对称的。

离散时域中

1. 单位抽样信号，常写作$$\delta(n)$$
2. 脉冲串序列，$$p(n)=\sum\limits_{k=-\infty}^{\infty}\delta(n-k)$$
3. 正弦信号，$$sin(n)=sin(t)\mid_{t=nT_s}=Asin(2\pi n\frac{f}{f_s}+\phi)=Asin(\omega n+\phi)$$。
4. 复正弦信号，$$e^{j\omega n}=cos(\omega n)+jsin(\omega n)$$
5. 单位阶跃信号，常写作$$u(n)$$。$$u(n)=\sum\limits_{k=-\infty}^{n}\delta(k)$$，$$\delta(n)=u(n)-u(n-1)$$
6. 指数信号，$$x(n)=a^{\mid n \mid}, \mid a \mid<1$$

### 2. 离散信号的运算

1. **延迟**（位移）。$$y_1(n)=x(n-k)$$，代表信号序列**右**移$$k$$个单位。但是$$n-k$$代表的是过去的时刻。反之亦然。
2. $$x(k)=x(n)\delta(n-k)$$，$$x(n)=\sum\limits_{k=-\infty}^{\infty}x(k)\delta(n-k)$$
3. 加减乘除发生在对应位置的信号。要求两个序列长度相同，时间范围相同。
4. 尺度变化。$$y(t)=x(\frac{x}{a})$$，若$$a>1$$，信号扩展，反之信号压缩。
5. 对于给定$$x(n)$$，$$y(n)=x(Mn)$$，称为$$M$$倍抽取，采样频率变为$$f_s/M$$；$$y(n)=x(n/L)$$，称为$$L$$倍插值，采样频率变为$$Lf_s$$。
6. 信号的分解。$$x=\sum\limits_{n=1}^N \alpha_n \phi_n$$，这就是一个分解，称$$\alpha_i$$为分解系数，$$\phi_i$$为基向量。如果$$\phi_i$$是一组两两正交的向量，该式称为正交展开（正交分解），分解系数即为信号在各个基向量上的投影。
7. 变换。信号的变换是分解的逆过程，相当于给定一个$$x$$信号和$$\phi_i$$的条件下求解分解系数。变换是将信号由一个域映射到另一个域内，常见的有傅里叶变换，希尔伯特变换，小波变换等。

### 3. 离散信号分类

####  - 按周期

$$x(n)=x(n+T)$$对于任取$$n$$成立。

####  - 按确知

确定信号，在任意时刻的值能被精确确定。

随机信号，在任意时刻的取值是随机的。

随机信号往往都是功率信号，分为平稳和不平稳。平稳信号分为各态历经和非各态历经。平稳表示其统计性质不随时间改变（严平稳），各态历经表示各个样本函数都经历了随机过程的各种可能状态。

####  - 按能量功率

对信号求能量的方法为

$$E=\int_{-\infty}^\infty|x(t)|^2dt$$

或

$$E=\sum\limits_{n=-\infty}^\infty|x(t)|^2$$

能量信号的标志是$$E<\infty$$。如果信号长度有限，一般就是能量信号。

而功率（能量的时域平均）的求法为

$$p=\lim\limits_{T \to \infty}\frac{1}{2T}\int_{-T}^T|x(t)|^2dt$$

或

$$p=\lim\limits_{N \to \infty}\frac{1}{2N+1}\sum\limits_{-N}^N|x(t)|^2$$

当$$p$$有限的时候，该信号就被称为功率信号。

时间无限的信号一般是功率信号，有限区间内的确定信号一般是能量信号。

####  - 按维度

#### 总结

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/ADSP.jpg)

### 4. 噪声

噪声时信号中无用的成分，生活中接触到的噪声有收音机的杂音、电视上的雪花点等。其来源很多，例如家用的50Hz交流电的干扰，热噪声（主要来源），量化噪声，其他设备的宽频干扰等。所有信号都会受到噪声的影响，在接收机端收到的噪声较为明显。一般我们认为，当信号比噪声强度大得多的时候，信号处理就不会受到显著影响。

**白噪声**：任意两个时刻的取值不相关（自相关函数为$$\delta$$函数），频谱为一条直线，在信号分析与处理的过程中是最常用的噪声模型。

**色噪声**：相对于**白**，只要噪声频谱不平坦就被认为是色噪声。

**脉冲噪声**：段时间间隔内出现尖脉冲。

我们常说的**高斯白噪声**，其**瞬时值的统计规律服从正态分布**，而**频谱又是一条直线**（白）。**热噪声就是高斯白噪声**。

噪声一般还分为加性和乘性噪声。

### 5. 信号空间

**赋范线性空间**。首先说啥叫“赋范线性空间”，之前的文章里面已经讲过什么是范数，线性代数中也简单介绍过线性空间的概念。我们假设信号$$x$$是线性空间$$X$$中的一个元素，记作$$x\in X$$，这里线性空间可以理解为向量空间。我们对信号重新定义范数如下

$$||x||_\infty =max\{ |x(t)|,-\infty<t<\infty\}$$

$$||x||_\infty =max\{ |x(n)|,-\infty<n<\infty\}$$

$$||x||_1 =\int _{-\infty}^{\infty}|x(t)|dt=\sum\limits_{n=-\infty}^{\infty}|x(n)|$$

$$||x||_2 =[\int _{-\infty}^{\infty}|x(t)|^2dt]^{1/2}=[\sum\limits_{n=-\infty}^{\infty}|x(n)|^2]^{1/2}$$

这些范数的计算方式还是相同的，只是因此被赋予了特殊的含义。例如无穷范数代表信号的最大幅度，1范数代表了信号的绝对和，2范数代表了信号的能量。我们可以针对每一类范数定义一个信号空间，例如

$$L_\infty ,l_\infty=\{ x:||x||_\infty <\infty\}$$

该空间代表最大幅度有界信号的集合。如果把范数换成2范数，则代表能量有限信号集合。这时我们说这个信号是绝对平方可积的。

我们说这三种信号空间都是线性空间，那么定义了范数的线性空间就被叫做赋范线性空间。范数中有一些特殊的性质，例如

$$||x+y||\leq||x||+||y||$$

**度量空间**：任取两个信号$$x,y$$，定义其距离

$$d(x,y)=||x-y||_2=[\int _{-\infty}^{\infty}|x(t)-y(t)|^2dt]^{1/2}$$

这个距离是一个有限值，且$$d(x,y)==d(y,x)$$，并且遵循三角原则$$d(x,y)\leq d(x,z)+d(z,y)$$。

度量空间实际上就是定义了距离的空间。

**内积空间**：仍设$$x,y$$是线性空间$$X$$中的元素，如果对任意的$$x,y\in X$$都有一个复数$$<x,y>$$与其对应，并且满足

1. $$<x,y>==<y,x>^*$$
2. $$<\alpha x+\beta y,z>==\alpha <x,z>+\beta <y,z>$$
3. $$<x,x> \geq 0$$

我们称$$X$$为内积空间，复数$$<x,y>$$即为内积，且满足

$$<x,y>==\int_{-\infty}^\infty x(t)y^*(t)dt$$

或

$$<x,y>==\sum\limits_{n=-\infty}^{\infty}x(n)y^*(n)$$

如果两个信号内积为0，我们说这两个信号是正交的。



**希尔伯特空间**是一个完备的内积空间

这部分太抽象了还是不写了。

> 在数学中，希尔伯特空间是欧几里德空间的一个推广，其不再局限于有限维的情形。与欧几里德空间相仿，希尔伯特空间也是一个内积空间，其上有距离和角的概念（及由此引申而来的正交性与垂直性的概念）。此外，希尔伯特空间还是一个完备的空间，其上所有的柯西序列等价于收敛序列，从而微积分中的大部分概念都可以无障碍地推广到希尔伯特空间中。希尔伯特空间为基于任意正交系上的多项式表示的傅立叶级数和傅立叶变换提供了一种有效的表述方式，而这也是泛函分析的核心概念之一。希尔伯特空间是公式化数学和量子力学的关键性概念之一。



**许瓦兹不等式**

对于信号空间中的信号，我们可以证明

$$|<x,y>|^2 \leq <x,x>·<y,y>$$

即两个信号之间的内积小于等于各自内积的乘积。可以写成积分或求和的形式。

### 6. 确定信号的相关函数

**要注意这个和我们学习的随机信号分析课程讲的不一样**

定义一个**相关系数**

$$\rho_{xy}=\frac{\sum\limits_{n=0}^\infty x(n)y(n)}{[\sum\limits_{n=0}^\infty x^2(n)\sum\limits_{n=0}^\infty y^2(n)]^{1/2}}$$

其分母为**两信号能量乘积的开方**，分子是**两个信号对应项的乘积（离散内积）**。根据许瓦兹不等式，显然这个系数是小于等于1的。

当两个信号完全相等的时候，这个结果取得1；当两个信号完全不相关的时候，该结果就是0。由于$$\rho$$的取值范围是0到1，因此也叫作归一化的相关系数。

但是相关系数只能评价两个信号的相似程度，却不能评价两个信号在不同位置的相似程度。对于两个正弦信号来说，只要将另一个信号平移$$\pi/2$$，相关系数立即从1降至0。

因此我们定义相关函数

$$R_{xy}(m)=\sum\limits_{n=-\infty}^\infty x(n)y(n+m)$$

根据x和y位置不同我们写作$$R_{xy}$$和$$R_{yx}$$，两者的关系是

$$R_{xy}(m)==R_{yx}(-m)$$

这个相关我们称作互相关，对于两个信号都为同一信号的情况，我们称其为自相关。自相关函数反映了信号和其自身延迟的相似程度，记为$$R_X$$等。

相关函数的性质有

$$R_X(0)=\sum\limits_{n=-\infty}^\infty x^2(n)=E_X$$

（如果这个信号不是一个能量信号，该结果往往为无穷大）

$$R_X(\infty)=m_X$$

DSP研究的是离散信号，对于离散信号，相关函数定义为

$$R_{xy}(m)=\lim\limits_{N \to \infty}\frac{1}{2N+1}\sum\limits_{n=-N}^N x(n)y(n+m)$$

自相关同理。特别的，自相关函数的周期和原信号周期相同（如果原信号是周期信号）。而且对于周期函数，我们计算时要更加简单

$$R_{X}(m)=\frac{1}{N}\sum\limits_{n=0}^{N-1} x(n)x(n+m)$$

对于复信号的自相关，我们常常（习惯）取**第一个**x为其共轭值。如果不做说明，我们认为实际信号都是实信号。

自相关函数还有一些性质，例如

1. 如果x是一个实信号，那么其自相关函数是实偶函数，如果x是一个复信号，那么相关函数$$R_X(m)=R_X^*(-m)$$
2. 自相关函数在0处取得最大值，这时候代表的是信号的能量。
3. 对于能量信号，当$$m \to \infty$$时认为自相关函数的值为。这与我们在随机信号中学习的不同，因为随机信号往往是一个功率信号。
4. 互相关函数不是偶函数，但是$$R_{xy}(m)==R_{yx}(-m)$$
5. 互相关函数在0处取得最大值为$$\sqrt{E_XE_Y}$$
6. 两个能量信号的互相关函数在$$m \to \infty$$为0

相关函数往往应用在噪声中信号检测、隐含周期性检测等领域。

## 三、 离散时间信号的傅里叶变换

### 连续时间信号FT

傅里叶发现任意一个周期信号都可以分解为无穷多个不同频率的正弦信号和，这个就叫做傅里叶级数，高等数学中有详细证明。

在电信人心中最完美的信号就是弦振荡信号，因为它幅度频率相位都是完全确定的，而且有许多数学上的性质，各自充分或必要地证明着这就是最完美的信号（于是我决定叫他“卡兹~~sama~~”信号（并不是。

弦信号有正交性，这也是我们选择它为基向量的原因（不理解这句话的可以往回翻翻）

#### 1. 连续周期信号

假设$$x(t)$$是一个周期为T的周期信号（且一个周期内能量是有限的），对于周期信号

$$x(t)=\sum\limits_{k=-\infty}^\infty X(k\Omega_0)e^{jk\Omega_0 t}$$

这个本质上是$$x(t)$$的一个分解，用于分解的基函数（向量）是复正弦。

这个系数我们可以表示为

$$X(k\Omega_0)=\frac{1}{T}\int_{-T/2}^{T/2}x(t)e^{-jk\Omega_0 t}dt$$

这个可以通过正弦的正交性得到。

傅里叶变换实际上是将信号$$x(t)$$和一组不同频率的复正弦做**内积**，这一组复正弦就是变换的基向量。傅里叶系数或变换可以看做是信号$$x(t)$$在基向量上的投影。

这个变换结果的含义是第k次谐波的系数，显而易见结果是离散的，频谱上的间隔为$$\Omega_0$$

周期矩形信号（周期为T，开通时间为$$\tau$$，幅值为A）的傅里叶级数是

$$X(k\Omega_0)=\frac{A\tau}{T}\frac{sin(k\pi f_0\tau)}{k\pi f_0\tau}$$

结果是一个Sinc函数型的。

#### 2. 连续非周期信号

如果连续非周期信号是一个能量有限的信号，那么FT就是

$$X(j\Omega)=\int_{-\infty}^{\infty} x(t)e^{-j\Omega t}dt$$

$$x(t)=\frac{1}{2\pi}\int_{-\infty}^{\infty} X(j\Omega)e^{j\Omega t}d\Omega$$

$$\Omega=2\pi f$$是角频率，单位是$$rad/s$$此时的变换结果是一个连续函数，称为信号x的频谱密度函数。

同样对于上面的方波信号，如果只有一个周期的话，就是一个门函数，其变换结果是

$$A\tau \frac{sin(\Omega\tau/2)}{\Omega\tau/2}$$

如果不是能量有限的，我们就不能直接进行FT。

---



对于第一种情况，我们得到的频谱是以$$\Omega_0$$为间隔离散的，而去除周期后我们发现频谱是连续的。

实际上两者存在联系，假设我们将连续信号的频率减小，即增大周期直到无穷大，频谱间隔$$\Omega_0$$就会降低至无穷小，极限情况就是连续谱。

**帕斯瓦尔定律**：信号在时域和频域计算的功率是等同的（功率也是）。

对于周期信号，如果要实现傅里叶变换，可以引入奇异函数。

其主要方法是

$$X(j\Omega)=\int_{-\infty}^{\infty} x(t)e^{-j\Omega t}dt  = \int_{-\infty}^{\infty} [\sum\limits_{k=-\infty}^\infty X(k\Omega_0)e^{jk\Omega_0 t}]e^{-j\Omega t}dt$$

提出求和项并让复频率项进行积分运算，根据

$$\int_{-\infty}^{\infty}e^{\pm jxy}dx=2\pi\delta(y)$$

得到变换结果

$$X(j\Omega)=2\pi \sum\limits_{k=-\infty}^\infty X(k\Omega_0)\delta(\Omega-k\Omega_0) $$

即周期信号的FT是由频率轴上间距其$$\Omega_0$$的冲激序列组成，强度为傅里叶系数乘$$2\pi$$。仍是离散频谱，周期信号的频谱相当于在无穷小的频率范围内取得一个无穷大的频谱密度。

这一段记住时域周期连续频域离散非周期；时域连续非周期频域连续非周期。

### 离散时间信号FT（DTFT）

就是离散时间傅里叶变换。时域信号是一个离散非周期信号，频域上得到连续频谱，但是是周期的。

$$X(e^{j\omega})=\sum\limits_{n=-\infty}^{\infty} x(n)e^{-j\omega n}$$

$$x(n)=\frac{1}{2\pi}\int_{-\pi}^{\pi} X(e^{j\omega})e^{j\omega n}d\omega$$

此处的$$\omega$$是数字频率，单位是$$rad$$，变换结果的频谱是一个连续函数，周期为$$2\pi$$。我们常见的z变换就是用$$z=e^{j\omega}$$进行代换。

现在我们已经有了三种傅里叶变换，应当还有一种离散到离散的对应关系。

> DFS：难道是我？
>
> DFT：没错正是在下

给个图理解一下

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/4FT.jpg)

#### 截断信号对DTFT的影响

以上DTFT都假定n为无穷，但是实际上要处理的信号一定是有限长度的（处理数字信号不可能处理无限长信号）。所以我们需要对信号进行截断处理。将无限长信号截断就相当于使用矩形窗乘信号。实际上截断就是加窗，直接截断我们称为矩形窗。对于矩形窗，实际上就是有效区域连续N个点全为1，无效区域全为0。

对矩形窗做DTFT得到

$$D(e^{j\omega})=e^{-j(N-1)\omega /2}\frac{sin(\omega N/2)}{sin(\omega /2)}$$

这个函数的最大值在$$\omega=0$$的时候取得为N，在$$\omega=2\pi k/N$$时都为0

相位响应是线性的，主瓣宽度$$B=4\pi /N$$，旁瓣衰减为-13.46dB。当矩形宽度N趋近无穷大时，该响应会趋近于$$\delta(t)$$。这一段还是有图看着舒服，有机会补上图。

数字域的Sinc函数就是sin/sin的形式。结果可以自行绘制查看，就是一个sinc函数的形状。根据频域卷积定理，时域乘法相当于频域的卷积，则相当于在频域上进行卷积sinc函数。

由于矩形窗在频域上是sinc函数的形式，因此会出现频率分辨能力的问题。假设信号中有两个频率相近的分量，那么就有可能出现卷积结果只有一个峰值的情况，例如

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/ADSPI.jpg)

显然，当我的矩形窗宽度越小，频率分辨能力就越差。我们可以理解为，截断部分保留的信息减少，从而导致频率分量不易辨别。

这个现象被称为频谱泄漏，泄漏往往会模糊原来真正的谱的形状，窗函数过大的旁瓣甚至会产生假的谱峰，从而导致错误的结果。

然而，所有有限长的信号都要看做一个无限长信号的和一个矩形窗相乘的结果，从而在频域发生畸变（与矩形窗以及频率分辨率（采样频率）有关）。

在最大峰值两边的第一个过零点之间的距离被称为主瓣宽度，我们希望主瓣宽度越小越好；相应的我们希望旁瓣的幅度越小越好，这样就能抑制泄漏。实际上矩形窗的主瓣宽度相当小，从而频率定位性最强，但是其旁瓣抑制过小，在实际应用中是一个很不好的窗函数。要注意，这两个参数不可能同时减小。

截短对信号产生的影响主要是降低频率分辨率和频谱泄漏。主瓣对信号产生平滑，所以频率分辨率降低。矩形窗主瓣较窄，产生的影响较小。而旁瓣就会引起频谱泄漏，可以看出矩形窗的频谱泄漏是最明显的，因为其旁瓣抑制最小。

### 连续时间信号抽样

有一种元件叫模数转换器，可以将输入的模拟信号进行采样量化，从而输出数字信号。这时数字信号处理过程中的一种必要器件。那么问题来了，~~挖掘机技术哪家强~~数字化后的离散信号究竟能否包含模拟信号中的全部信息？二者的FT结果是什么关系？能否从数字信号中恢复模拟信号（的信息）？

首先是采样定理的问题。根据奈奎斯特采样定理，只要$$f_s \geq 2f_{max}$$，我们就能无失真地获取模拟信号中的信息。这个详细内容应该不用，那考虑到我有读者还是说一下吧（假装有人看嘤嘤嘤

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/ADSPorigin.jpg)

这个是我们的原始信号序列，其中左边是时域信号，右边是频域信号。

我们用来采样的是冲激串

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/samplingseries.jpg)

冲激串在时域是冲激，做FT后还是冲激。时域采样是乘法，在频域上就是卷积。卷积结果如下

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/conv.jpg)

注意这个卷积，如果冲激串频率高，那么频域间隔就会很大，卷积后的结果就不容易出现混叠。如图没有出现混叠，因此我们认为信息没有丢失。要恢复信息也很简单，采用低通滤波器就好了。最后结果还要做一个归一化这里不再继续做了。



上面还有一个问题，就是采样前后FT的关系。关系就是

连续信号FT得到$$X(j\Omega)$$，对连续信号进行抽样，表现在频域上，频谱出现周期延拓。对时域做归一化处理，频谱坐标归一就得到了$$X(e^{j\omega})$$

BTW，实际上采样定理对窄带信号操作的时候，并不需要满足最大频率的两倍，而是与带宽满足一定关系就好。

数字处理后要恢复原来的信号，实际上也很简单，理论上有一个理想低通滤波器，只保留需要的低频内容即可。只要满足抽样定理，由无穷多的加权移位sinc函数和就可以重建原信号。

假设理想低通滤波器频率响应如图（中）

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/recover.jpg)

左信号与 中间的滤波器做乘积就得到了右边的频谱，即恢复了原信号。这个过程相当于时域上卷积sinc函数，相当于在任意t时间上按卷积插值。

（公式需要背吗好复杂啊）

理论上bb了这么多，带入弦函数试一试，假设正弦函数$$x(t)=Asin(2\pi f_0 t+\phi)$$，那么它的频谱是在$$\pm f_0$$处的$$\delta$$函数。按照抽样定理，我们取$$f_s=2f_0$$进行抽样，那么在一个周期内只能取得两个点。实际上我们并不知道这两个点来自于什么信号，而且这两个点的值还随着相位在变化。如果这时候取样点正好是0，我们实际上没有得到这个信号的任何信息；如果取样点正好是最高值点，我们也不知道这两个点来自于谁——方波、三角波或其他波都会出现这样的采样结果。虽然我们很明确，对这个结果加一个低通滤波，一定会得到一个正弦函数。

而对于正弦函数，由于其频谱是一个冲激，因此在截断后一定会出现sinc状频谱，中心频率处的能量不可避免的分散到其他位置去了。

对于未知正弦信号，应先使用示波器简单观测一下信号，然后采用三倍及以上的倍数对信号进行采样。在做FFT的时候，抽样频率建议采取信号频率的四倍以上，即每周期四点。截断数据时，一般也要求截断信号包含整数个周期（减少泄漏）。

### 离散时间周期信号的傅里叶级数

当需要处理的的信号是一个离散周期信号的时候，根据我们前面介绍的规律，频谱应当是离散（时域周期）周期（时域离散）的。但是这时候的信号是功率信号，并不能直接做DTFT。

首先对周期为T的信号做傅里叶级数展开，这个是允许的，只要一个周期内的能量有限就可以。我们将得到

$$x(t)=\sum\limits_{k=-\infty}^{\infty}X(k\Omega_0)e^{jk\Omega_0 t}$$

这个展开是离散非周期的。现在我们对时域信号做抽样，假设抽样频率为$$f_s$$，时间间隔即为$$T_s$$，得到结果为

$$x(nT_s)=\sum\limits_{k}X(k\Omega_0)e^{j\frac{2\pi}{N} nk}$$

($$\Omega_0=2\pi/T=2\pi/NT_0$$)

这样我们就得到了一个离散周期的结果，周期为$$\Omega_s$$，而正因为结果是周期的，所以求和要在一个周期内进行，上下限就此抹去。时域进行了N点取样，基波频率为$$\Omega_0$$，此时$$\Omega_s=2\pi/T_s=2\pi N/T_s=N\Omega_s$$

因此说频谱一个周期内有N个点。

### DFT

以上求和过程与$$\Omega_0$$不再相关，因此可以将结果写成$$X(k)$$，其中k的取值是正负无穷（周期信号）。我们称其为DFS，离散周期序列的傅里叶级数。如果我们忽略二者的周期性，只取其中的一个周期用于分析，我们就会得到DFT。这个我们叫做离散傅里叶变换。

DFT实际上是与DFS相同的，不同点就在于只有一个周期。对于数字信号来说还是单周期易于分析，因此DFT也更广泛应用于DSP行业。

重新写一遍DFT的定义

$$x(n)=\frac{1}{N}\sum\limits_{n=0}^{N-1}X(k)e^{j\frac{2\pi}{N}nk}$$

$$X(k)=\sum\limits_{n=0}^{N-1}x(n)e^{-j\frac{2\pi}{N}nk}$$

并说明，DFT并不是一种新的变换，只是DFS做了一个周期的截断，而对于有限长为N的非周期序列，在做DFT时我们都会假定这一部分是整个序列的一个周期。对于无限长的序列，我们就要对序列进行加窗，截断为N点，并认为这N个点是某一个周期序列的一个周期。

对于时间有限的信号我们并不能得到频域带限的信号，但是我们在进行DFT时会假定这个信号是一个周期序列的一个周期，因此本质上是对一个无限长信号进行变换，因此结果频域是带限的。

但也正是这个原因，我们本来的信号并不是周期信号，因此在反变换回来的时候会出现时域混叠，因此说$$x(n)$$（反变换结果）是原时域信号的一个近似（而非采样）。

#### DFT的正交性

变换时为表达方便，我们常将相位写作

$$e^{-j\frac{2\pi}{N}nk}=W_N^{nk}$$

这样可以将求和的结果写成矩阵相乘的形式，

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/DFT.png)

这个矩阵是一个正交矩阵，满足$$W^*_NW_N==NI$$，所以我们称DFT为正交变换。常常也写作

$$X_N=W_Nx_N$$

#### 循环卷积

循环卷积又叫做圆周卷积，对于两个N点的序列，卷积结果仍然是N点序列。实际上就是两个序列的错位相乘结果的求和，按顺序写成N点序列。注意二者的方向始终是相反的，例如

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/DFT2.png)

循环卷积是对应于DFT的卷积，两个序列的DFT的乘积就是两个序列的循环卷积，反之也成立。

当然并不是说DFT不能计算线性卷积，如果事先对两个序列进行补零操作（对于长度为N和M的序列，就应该补零到N+M-1，即线性卷积后的序列长度），然后再对DFT相乘求反变换，就能得到两个序列的线性卷积。

### FAQ

#### 1. 频率分辨率以及DFT参数的选择

频率分辨率有两种定义，一般在教学时讲的是仪器分辨频率间隔的物理极限。

**第一种定义**是，某一种算法将原信号中两个靠的很近的谱峰保持分开的能力，用来检验算法的好坏。在FT中假设信号长度为T，假设视为无穷长度信号与长度为T的矩形窗进行相乘，则$$\Delta f$$可以定义为$$1/T \ Hz$$。

这个变换结果就是原信号频谱对sinc函数做卷积。假设原信号中存在两个谱峰，想要辨别这两个谱峰，就需要

$$4\pi /T < abs(\Omega_1-\Omega_2)$$

如果我们采用DTFT的方法，假设抽样间隔为$$T_s$$，抽样点数就是$$N=T/T_s $$。想要分辨两个谱峰，就需要

$$4\pi /N < abs(\omega_1-\omega_2)$$

这个频率是归一化的频率。

此时频率分辨率定义为

$$\Delta f=f_s/N$$

如果采用其他窗函数，由于主瓣宽度的不同，频率分辨率也会产生变化，与其他窗函数相比，矩形窗对频率分辨的能力是最强的了。在有些文献中，DTFT定义的分辨率有时被称作**物理分辨率**。

对于一个仪器设备来说，如果要提高设备的采样频率，受限于物理极限，它的采样点数也会增加；相应的也是相同道理。因此我们说频率分辨率不是容易轻易改变的。

**第二种定义**是在DFT中定义的。相比前面在DTFT中的定义，DFT中用相同的表达式定义$$\Delta f=f_s/N$$为计算分辨率，是频率轴上最小的频率间隔。当我们对一个信号观测不完全时，可以通过补零的方式将信号看的更加详尽（增加了N），但是对于频率分辨率来说是不会提升的。

DFT中N指的是序列的长度，但是DTFT中的N指的是有效序列长度，与T有关，分辨率与窗函数的主瓣宽度有关。

总结起来就是，在数据长度一定的条件下，采用不同的窗函数将在频率分辨率与频谱泄漏之间取舍。频率分辨率取决于信号长度和频谱分析的算法。除了频率分辨率还有时间分辨率的问题，他们也存在相互制约关系，此处不展开简介。

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/ADSPeg.png)

我们可以自己使用MATLAB做一个测试。

一般的我们认为，首先选取一个高于最高频率二倍的采样频率，并根据频率分辨率要求设置信号长度N，并且尽量是2的整数次幂。此时根据N和采样频率我们还可以确定模拟信号的频率。

#### 2. 补零问题

补零不能提高频率分辨率，因为信号的有效长度就那么长，补零没有帮助。另外2的整数次幂有利于FFT的运算，数据过短时，补零可以对频域产生插值效果，有利于辨认频谱本身的形状。

#### 本章考点

1. 四种傅里叶变换的概念、区别及联系。
2. 截短信号的影响频率分辨率降低与频谱泄漏
3. 抽样定理（正弦抽样）
4. DFT导出，DFT与FT、DTFT的关系
5. 圆周卷积和线性卷积
6. FAQs





## 四、 变速率信号处理

线性时不变系统始终工作在相同信号速率的条件下，即系统输入、输出以及中间环节的信号采样频率相同，但是实际上在不同任务下采用不同的采样速率可能对该任务更合适，因此需要采样速率转换的技术。转换的原则就是不能使信号失真。

采样速率转换技术是软件无线电的理论基础。据说软件无线电技术前一阵火了一段时间，后来又销声匿迹掉了（纠正，只是没有发展的时候那样的井喷了，还是有很多人在研究的）。由软件平台定义通信协议，而不依赖于专用硬件。

采样率转换技术常用在宽窄带联合处理的系统中，用意是降低计算复杂度，降低传输速率，并减少存储量。在采样定理满足的前提下，实际上最容易想到的方式是将某一抽样信号进行DA转换，并经过另一个AD转换变成另一种频率。这方法有脑子的人都会觉得不行。槽点太多吐不过来了。

#### 下采样（降速率）

下采样实际上就是将原信号的速率降低为原始速率的1/M。原信号每隔M-1个点就取一个数据点，其他位置取零，就可以形成一个新序列，我们称其为抽取。抽取后信号的间隔提高了M倍，速率也就降了下来。抽取具有线性时变（周期时不变）的特点。

下采样一般分为两个步骤

1. 离散采样（抽取）
2. 信号压缩（将0去除）

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/downI.jpg)

分析是不会分析的，这辈子都不会分析的。

最终在频谱上的反应是

1. 下采样后的频谱幅度缩小为1/M
2. 下采样后的频谱时原始频谱的M倍扩展
3. 周期仍然是$$2\pi$$

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/ori.jpg)

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/after.jpg)

看起来带宽展宽了，实际上并不是。这里是归一化频率。实际上带宽不会有任何变化。

想想也是，虽然是采样，但是也只是对信号进行采样而已，信号又不会失真。

下采样有可能产生频谱的混叠。当时域间隔过大的时候，频域间隔就会越来越小直至出现混叠，这就会失真了。不发生混叠的条件是

$$\omega_x \leq \pi/M$$

理解不了看图

混叠的后果

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/Aliasing.jpg)



为了防止出现频谱混叠，因此在下采样过程中药增加一个滤波器，将信号带限至$$\pi/M$$

实际上并不是对信号频域做截断，而是在满足采样速率的条件下，将信号有效区域外的噪声滤除。完整的抽取器如图

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/DownScale.png)

抗混叠滤波器一般是低通滤波器，信号也一般是满足带限要求的，抗混叠滤波器的作用一般就是抑制混叠噪声。

#### 上采样（升速率）

上采样就是将信号速率升为原始速率的L倍，我们一般称过程其为内插。内插是在两个采样点之间插入（L-1）个数据点，以形成一个新的序列。内插时一般采用内插0的操作，然后使用低通滤波器就能获取上采样信号。

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/UpScale.jpg)

上采样同样具有线性（叠加性与均匀性），同样不满足时不变性。经过计算可以得到，上采样的频谱时原始频谱的L倍压缩。

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/USI.jpg)

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/USII.jpg)

上采样前后带宽也是没有改变的，记住原则是信号无失真。但是上采样的抽取过程会产生镜像频率。注意看上面的图，我们可以看见在$$2\pi$$范围内多出来了一组频谱，我们需要抑制这个频谱（对于L倍上采样，会多出（L-1）组），因此需要设计滤波器。

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/UpScale.png)

完整的内插器会在上采样后增加一个抗镜频滤波器，利用低通滤波除去（L-1）组高频镜像。当然实际上抗镜像滤波器可以设计为带通滤波器，这样就能实现上变频。抗镜像滤波器设计需要在保证信号带宽的基础上尽量抑制镜像频率。

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/FullUpScale.jpg)

可以看出内插的0变成了准确值，信号没有产生失真，而且提高了时域分辨率。

#### 分数倍采样率转换

通过抽取实现M倍下采样、通过内插实现L倍上采样，级联内插器和抽取器就可以实现分数倍采样速率转换。

抽取和内插的顺序是可以调换的，原则是计算次数最少。而且考虑到内插器与抽取器的滤波器位置，经常将信号先内插后抽取，实现滤波器的复用（但是效率并非最高）。以上都需要在满足信号无失真的条件下进行。

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/expI.png)

其中等效滤波器的截止频率应当取两者截止频率的最小值。

### 多级系统

实际应用中很难一次操作完成较大倍数的采样率转换（较大倍数的抽取或内插需要很窄通带的滤波器，实现此类滤波器需要很高的阶数，实现难度高），因此常采用多级系统。数字信号的处理中噪声不会每级累积，而是在抽样判决后消除，因此多级系统不会像模拟电路那样产生积累噪声。

将抽取或内插的倍数分解为多个小整数的乘积，再进行多级系统拆分，如果首先对信号进行多级内插再对信号进行多级抽取，中间的滤波器还是可以等效为一个滤波器。

多级系统的目的是增加滤波器的可实现性，但是由于多级滤波器的带内波动会累加，因此设计时需要严格控制带内平坦度为单级实现的K倍（K=ML）

### 变速率DSP过程中的数字滤波器设计

滤波器设计思想

1. 使信号失真最小
2. 降低复杂度，实现结构简单，满足实时性要求（低延迟）

滤波器中存在六个恒等关系

1. 多路信号先叠加后抽取可以等效为先抽取后叠加。
2. 信号先延迟M后M倍抽取等效为先M倍抽取后延迟1
3. 信号先经过滤波器$$H(z^M)$$后M倍抽取等效为先M倍抽取后通过滤波器$$H(z)$$
4. 信号先内插L倍后分路等效为先分路后（分别）内插
5. 信号先延迟1后内插可以等效为L倍内插后延迟L
6. 信号先经过滤波器$$H(z)$$后内插L等效为先内插L后经过滤波器$$H(z^L)$$

FIR滤波器有良好的线性相位特性，而IIR滤波器实现更为简单（相位狗屎）。

在DSP中如果我们希望信号不出现群时延（失真），那就需要采用线性相位的滤波器，即FIR滤波器。如果我们对相位不敏感就可以采用IIR滤波器。

#### FIR抽取器直接实现结构

常见的数字滤波器实现的结构（直接型）实现如下

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/direct.jpg)

信号输入后，对信号进行多级延迟后乘一个增益就相当于卷积操作，这个过程就是滤波。滤波后进行下采样，获得降速率的信号。根据恒等关系，该结构相当于先对数据进行降采样然后滤波，此时滤波器进行的运算次数（主要是乘法）就大大减小。乘法在运算中复杂度远高于加法，因此该操作可以显著降低运算的复杂度，提高处理的实时性。但是需要更多的抽取器，典型的花钱买效率的操作。这个实现我们称为**高效实现结构**，因为乘法的运算次数降低为$$1/M$$次，若滤波器系数对称，甚至可以再降低一半的乘法次数。

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/HE.jpg)

如图即为偶数阶系数对称的FIR抽取器的高效结构。加法运算复杂度远比乘法小（乘法的计算时钟大约比加法多100倍）

#### FIR内插器直接实现结构

内插时要先进行内插后进行滤波抑制镜频。内插是抽取的反操作，只要我们将上一个结构完全颠倒就得到了内插器的结构。

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/UP.jpg)

容易知道内插0值时不用乘法运算，因此我们的乘法操作可以在内插前执行，根据恒等关系我们可以将内插放在乘法后，类似上面实现的原理。此时计算乘法次数降低为$$1/L $$系数对称时还可以再降低一半。

#### FIR抽取与内插滤波器的多相实现

经过高效处理后，系统的复杂度仍然很高，还有优化的余地。我们仔细观察就会发现，滤波器都工作在高频率端口，即内插后，抽取前。这就给滤波器设计带来了负担。因此引出滤波器的多相实现方法，使滤波器工作在低速率截断，降低处理速度的需求。

高阶FIR滤波器可以由基于多相分解的并行结构来实现，FIR滤波器的传输函数被分解为M个低阶传输函数的方法叫做多相分解方法。这M个低阶传输函数的和就等效为原始传输函数。

FIR滤波器的传输函数可以写作

$$H(z)=\sum\limits_{n=0}^{N-1}h(n)z^{-n}$$

将该式按照偶次系数和奇次系数分为两部分，考虑到一般性，我们假定阶数N为奇数，表达式可以分组为

$$H(z)=\sum\limits_{n \in 奇数}^{N-1}h(n)z^{-n}+\sum\limits_{n \in 偶数}^{N-1}h(n)z^{-n}$$

将奇数和项提出一个$$z^{-1}$$，原式可以写为

$$H(z)=h(0)+h(2)z^{-2}+...+h(N-1)z^{-(N-1)}+z^{-1}[h(1)+h(3)^{z^{-2}}+...+h(N-2)z^{-(N-3)}]$$

我们可以定义多相分量为

$$E_0(z)=h(0)+h(2)z^{-1}+...+h(N-1)z^{-(N-1)/2}$$

$$E_1(z)=h(1)+h(3)z^{-1}+...+h(N-2)z^{-(N-3)/2}$$

就可以将传递函数表示为

$$H(z)=E_0(z^2)+z^-1E_1(z^2)$$

这只是分为两组。如果我们尝试将滤波器系数分为M组，就将得到

$$H(z)=\sum\limits_{K=0}^{M-1}\sum\limits_{n=-\infty}^{\infty}h(nM+K)z^{-(nM+K)}=\sum\limits_{k=0}^{M-1}z^{-k}E_k(z^M)$$

当无法整除时，各组向下取整，且各个组的$$h(n)$$个数可以不相等。

如此可将滤波器分解为并行的M个多相分量，并在输出端叠加。这样的多相分量有时也被称为多相子滤波器。M倍抽取滤波器分解为M个多相分支，再利用恒等关系，可以将滤波器安排在低速率端。此时实时性是变差的。

另外每一个多相支路的数序列可以表示为序列的延时+抽取，可以设计一个旋转器，实现如图的处理

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/re.png)

对于内插器有同样的原理，结构也与这个相似

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/reII.png)

衡量变速率系统的高效性的一个常用统计量是**每秒钟需要运算乘法的次数**。

多相滤波的有点在于降低了运算复杂度，并降低了滤波器阶数。



FIR计算复杂度

**抽取器**

直接型$$R_{M\_DEC}=Nf_x$$

多相型$$R_{M\_DEC}=\frac{Nf_x}{M}$$

**内插器**

直接型$$R_{M\_INT}=LNf_x$$

多相型$$R_{M\_INT}=Nf_x$$





### IIR抽取内插滤波器的直接实现结构

IIR滤波器前面就说过，阶数比FIR低很多，相同性能下运算量很少。FIR滤波器经过以上的各种操作后仍然要比IIR效率低，但是IIR相位非线性，还对量化噪声敏感。

算了看了一遍发现我并不会。记几个公式算了

IIR计算复杂度

**抽取器**

直接型$$R_{M\_DEC}=Nf_x+\frac{(N+1)f_x}{M}=\frac{MN+(N+1)}{M}f_x$$

多相型$$R_{M\_DEC}=\frac{Nf_x}{M}$$

**内插器**

直接型$$R_{M\_INT}=(N+1)f_x+LNf_x=[LN+(N+1)]f_x$$

多相型$$R_{M\_INT}=Nf_x$$

### 典型高速数字滤波器

在实时性要求很高的时候，往往采用特殊滤波器，高速数字滤波器。一般我们说，采样速率越接近处理时钟的速率，实时性要求就越高。这里介绍两类高速数字滤波器

#### 1. 半带滤波器

半带滤波器是指频率响应满足以下关系的FIR滤波器

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/HalfBandFilter.jpg)

$$\omega _A=\pi-\omega_C$$

半带滤波器的阻带宽度和通带宽度是相等的。其中的$$\omega_A$$是幅频响应中阻带开始的位置；$$\omega_C$$是通带宽度。

$$\delta_S=\delta_P=\delta$$

该滤波器还满足通带波纹与阻带波纹相等。

半带滤波器在$$\pi/2$$频率处的响应是0.5。某种意义上讲，半带滤波器可以说是一种滚降滤波器，其频域上**满足无码间串扰的条件**，因此时域上在一些特殊位置上响应为0。经过计算我们会发现，处于偶数点处的时域响应都为0（除0点响应为1以外）。这一意料之中的了，毕竟是一个Sinc函数。使用半带滤波器滤波时，只需要一半（左右）的运算量，适合实时处理。

半带滤波器满足的频域条件使其只能在两倍抽取的时候使用。但是毕竟不是理想滤波器，因此在做二倍抽取的时候，$$(\pi/2,\omega_A)$$上的数据会混叠到$$(\omega_C,\pi/2)$$中而无法恢复。因此可以采用半带滤波器处理频率在$$\omega_C$$之间的信号，此时信号可以恢复出来。当然在使用前一定要注意使用条件，信号带宽不能高于$$\omega_C$$。

但是$$\omega_C$$越大，半带滤波器的过渡带就越窄，滤波器的阶数要求就越高，越难以实现。

#### 2. 积分梳状（CIC）滤波器

积分梳状滤波器就是积分滤波器+梳状滤波器。简单级联就可以。

单级积分滤波器的传递函数为

$$H_I(z)=\frac{1}{1-z^{-1}}$$

单级梳状滤波器的传递函数为

$$H_C(z)=1-z^{-D}$$

那么单级积分梳状滤波器的传递函数就是

$$H(z)=\frac{1-z^{-D}}{1-z^{-1}}$$

经过一番化简我们可以得到，梳状滤波器的幅频特性，就是正弦函数

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/FilterI.jpg)

单级积分滤波器的幅频响应就是（算法很精妙啊

$$H_I(e^{j\omega})=\frac{e^{j\omega/2}}{2}[sin(\omega/2)]^{-1}$$

这两个相乘就会得到如下结果（其中$$Sa$$就是数字域的Sinc函数。

$$\mid H(e^{j\omega})|=|D \ Sa(\frac{\omega D}{2})Sa^{-1}(\frac{\omega}{2})|$$

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/CIC.jpg)

从0到第一个零点（坐标$$\frac{2\pi}{D}$$），这个叫主瓣，其他的都是旁瓣。随频率增大，旁瓣的电平是不断减小的。当$$D\gg 1$$时，第一旁瓣衰减为13.46dB。阻带抑制很差。仔细一看这不就是Sinc么，反变换回去就是矩形波。为了增大阻带抑制，人们常用级联法级联多个CIC滤波器。N级CIC滤波器的传递函数就是原传递函数的N次幂，阻带抑制变大为N倍。单级积分梳状滤波器的冲激响应就是矩形波。因为所有滤波器系数都是1，因此又称为简单整系数滤波器。该滤波器只有加法没有乘法，是FIR效率最优滤波器。

需要额外注意的一点是，该滤波器存在一个处理增益D，该处理增益随着抽取因子D（下采样倍数）增大、级数的增加而增大，因此CIC滤波器在使用时会出现一个增益，每一级都需要留出足够的运算精度，否则可能会出现溢出错误。

CIC滤波器也无法满足无混叠抽取的要求，信号带宽越大，越容易受到混叠影响（废话）。CIC滤波器带内容差（带内平坦度）也随着信号带宽增大而增大。我觉得这里都在说废话，但是判断平坦度的依据要知道，在$$\omega_S$$处的带内容差为

$$\delta_S=20lg(\frac{\mid H(e^{j\omega}) \mid\mid_{\omega=0}}{\mid H(e^{j\omega}) \mid\mid_{\omega=\omega_S}})$$

总之信号的带宽越小，受到CIC滤波器的混叠影响与带内衰减影响就越小。级联级数越大阻带衰减就越高，带内容差也随之增大。CIC滤波器的级联级数不能任意选取，多级级联虽然能增大组带内衰减，减小混叠影响，但是却增大带内容差（不平坦度），所以CIC滤波器的级联级数不应太大。内插或抽取因子D也应当适当，都则会导致信号带宽在主瓣内比例增大，导致带内容差增大。

总结一下，滤波器设计其实是个取舍的问题，所有参数都是相互制约的，在一个参数上做的好时，其他参数上的效果就未必好了。因此要针对我们遇到的问题，进行选取滤波器。顺带提一句，由于CIC滤波器不需要计算乘法，所以一般工作在系统的最高频率位置（一般是最前级）。

## 五、 小波变换

信号的变换就是从一个域到另一个域的映射过程。

常见的简单变换是傅里叶变换，实际上就是从时域到频域的映射过程，这个映射本质上是一种内积。内积可以理解为一种投影，即信号在一个多维向量基上的投影。傅里叶变换的基向量是$$e^{jwt}$$，复频率向量，可以理解为信号在复频率向量基上的投影（或者叫分量）。傅里叶变换的本质也就是在频域上对信号进行分析，由于变换（内积）时的基向量是复频率向量，因此变换结果就是在复频率上的分量，分量的大小就代表着这种成分在信号中所占的比例。值得一提的是，傅里叶变换的基向量是正交的，此时每个投影之间没有相关性。

傅里叶变换虽然可以将信号表示成一组不同频率信号的复频率信号加权和的形式，但是是一种纯频域的分析方法，他在频域的定位精度是完全准确的（频域分辨率最高，即每一个信号在某一个频率上的分量是完全准确的），但是在时域上却没有任何定位性。同一个信号，正序与逆序的傅里叶变换是完全相同的。可以说，傅里叶变换丢失了所有的时间信息，不能判断某一个信号频率分量是在什么时候产生的。

还有一种变换叫$$\delta$$函数展开，这种变幻的基本思想是把信号表示为延时的单位冲激函数的加权和，它在时域的定位是完全准确的，但是在频率域上是完全没有分辨能力的，可以说这个变换就是时域分析（其实就是时域分析），没有任何频域分辨能力。

---

以上的分析法还都是针对平稳信号或确知信号的，对于一些常见的非平稳信号，例如音乐信号、语音信号、探地信号等，他们的频域特性都是随时间变化的，都是时变信号。对这一类信号进行分析时往往只需要提取一部分，一部分时间段或一部分频段的信息，因此傅里叶变换就没有任何用了。我们需要一种介于时域分析与频域分析之间的分析方法，这种方法在时域和频域上都有一定的分辨率。

例如我们分析地震信号的时候，地震信号并不是时刻都有的，往往只有很少一段时间会发生，而且发生的很不规则，几乎是不能预测的。这时并不能使用傅里叶变换自动对频域进行分析。对此问题，人们发明了短时傅里叶变换的方法（STFT），即设定一个合理大小的固定窗口对长信号做截断（加窗），这样就会得到一个二维变换结果，即频率$$\omega$$和时域窗宽度$$\tau$$的函数。STFT的致命缺陷是，窗函数大小是固定的对于高频信号来说，持续时间短，应采用小窗，对于低频信号则应采用大窗。但是STFT的窗口不能改变，因此STFT存在一定的局限。

另外在计算时，人们希望将基函数离散化，甚至构成正交基，节约计算时间和存储空间。小波变换继承并发展了STFT的局部化特点，克服了窗口大小不随频率变化、缺乏离散正交基的缺点。

小波变换的基本思想是将波形按一个确定函数的伸缩、平移系展开，我们记小波函数为$$\psi(t)$$

那么它的伸缩平移系就是

$$\psi_{a,b}(t)=\frac{1}{\sqrt{\mid a \mid}}\psi(\frac{t-b}{a});a,b \in R, a \neq 0$$

通过这种方法我们可以将时频分析推广到将信号分解成对任意空间和尺度的贡献。



#### 连续小波变换

我们说的小波就是小区域波。小波函数需要满足若干条件，具体如下

1. $$\psi(t)$$平方可积
2. 傅里叶变换$$\Psi(\omega)$$满足$$C_\psi=\int\limits_{R}\frac{\mid \Psi(\omega)\mid ^2}{\omega}d\omega$$有限

这时我们就说该函数是一个基本小波（或小波母函数），其中条件2还可以写作小波函数直流分量为0（无穷区间积分为0）。

小波函数在时域定义域有限或近似有限（在无穷远处消失），直流分量为0.连续小波变换中，用于做内积的小波基函数定义就是基本小波$$\psi_{a,b}(t)=\frac{1}{\sqrt{\mid a \mid}}\psi(\frac{t-b}{a});a,b \in R, a > 0$$的伸缩和平移，a被称为尺度因子，b是平移因子。由于a和b是连续变化的值，因此被叫做连续小波基函数。

常见的小波函数有很多，以Marr小波为例，其时域表达式为

$$\psi(t)=(1-t^2)e^{-\frac{t^2}{2}}$$

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/Marr.jpg)

图中我们可以看到，b是平移因子，b的取值直接影响的是小波的位置；a是尺度因子，由于a的变化，小波的宽度和高度发生着变化。a越大，小波的时域尺度越大，幅度越小；a越小，小波时域尺度越小，幅度越高。同时在频域上我们看见，a越小时，频率的高频分量越高，但在频域上更为发散一些；a越大时，频域的在低频上更为集中分布，频域上更为收紧一些。但是由于直流分量始终是0，因此在0频率处始终没有频率分量。这就保证了在a变化时，小波的频域也做着尺度变化，而不会发生移动。

将不同的a和b值下的时域频域窗口绘制在一张图上我们就更容易看到，当时域窗口增大时，频域窗口在减小；当时域窗口减小时，频域窗口在增大。

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/tomega.jpg)

总结小波基函数的特点，小波函数在时域频域都具有有限或近似有限的定义域（注意，时域带限频域必然无穷限，但是近似有限是我们可以近似认为后面的摆动对结果不产生明显影响），在经过伸缩平移变换后该特性保留；尺度因子a和时域窗口的大小成正比，与频域窗口大小成反比，这并不是说a受他们的控制，相反的这两个窗口大小都是由a来控制的，某种意义上讲$$1/a$$是一种频域的对应。时间窗大小$$\Delta t$$与频率窗大小$$\Delta \omega$$的乘积称为窗口面积，通过上面的图可以看出，窗口面积大小是一定的，与a和b取值无关。但是这也告诉我们时域窗口大小与频域窗口大小是存在制约关系的。

另外，母小波函数可以看做是频域带通滤波器。我们之前说傅里叶变换就是一个信号通过一个特殊滤波器组，实际上小波变换也是一个道理。

这样，小波变换的定义就是

$$CWT_f(a,b)=\frac{1}{\sqrt{a}}\int_{-\infty}^{\infty}f(t)\psi^*(\frac{t-b}{a})dt$$

连续小波变换就是信号与小波函数的内积，反映了信号在小波基函数组上的投影。

前面提到的容许性条件$$C_\psi$$在逆变换这里用到

$$x(t)=C_\psi \int_{0}^{\infty}\frac{da}{a^2}\int_{-\infty}^{\infty}CWT(a,b)\psi_{a,b}(t)db$$

我觉得这变换就已经不是能手算的了。

小波变换与傅里叶变换都是一种积分变换，但是小波基函数有a，b两个参数，绘制出来的结果应是一个二维图形，是将一个时间函数投影到二维时间-尺度平面内，这将有利于提取函数的某些本质特征。当尺度a比较大的时候，小波函数的时间窗比较大，频率窗比较小，中心频率较小，因此有利于分析信号的低频成分；当尺度a较小的时候，情况相反，有利于分析高频信号成分。

#### 连续小波函数的相关性

（这一段我还没学懂呢= =）

连续小波变换并不是一种正交变换，任意函数的小波系数之间都是存在一个相关关系的，我们用相关系数K来表示

$$K=C_\psi^{-1}\int\limits_{R}\psi(t)\psi^*(t)dt$$

K表征了a-b半平面上任意两点之间的CWT系数之间的相关关系，称为再生核或重建核函数，其结构取决于小波函数的选取。再生核的含义是指通过a-b半平面上的已知点，根据再生核公式可以再生或重构处另外一点，再生核方程如下

$$CWT(a_0,b_0)=\int_{0}^{\infty}\frac{da}{a^2}\int_{-\infty}^{\infty}CWT(a,b)K_\psi(a_0,b_0;a,b)db$$

任意函数的小波变换在a-b域上都必须满足重建核方程。

但是我们也能发现，按这样计算的话，CWT过程中的计算必然存在很大的冗余量，因为系数之间彼此存在一定的相关性。从另一方面看我么可以认为这有利于实现信号的去噪或数据恢复。

#### 连续小波变换的性质

线性、时不变性、尺度不变性都满足。

时域微分相当于a-b域对b偏微分；

时域卷积相当于其中一个信号的CWT与另一个信号的卷积（将t换成b）

帕斯瓦尔定理依然满足。

#### 常见小波

*日后补充一下时域频域的表达式

1. Morlet小波
2. Marr小波（墨西哥帽小波）
3. 紧支集样条小波

#### 应用举例

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/CWTsine.jpg)

#### 离散小波变换（DWT）

前面说到了，小波变换计算冗余度很高，计算效率会降低。为了降低小波变换过程中的计算冗余度，我们将小波基函数的a和b限定在一些离散的点上取值。首先对a进行离散化，尺度离散化常用方法是令$$a=a_0^m$$，一般取$$a_0=2$$，这样就能取得一系列离散尺度值。时间尺度b的离散化，通常采用均匀离散取值，覆盖整个时间轴，类似采样，并且保证要满足Nyquist采样定理。

当$$a_0=2$$时，每当m增加1，尺度a增加一倍，对应的频带减小一半，采样频率可以降低一半，采样间隔可以增大一倍。

举例，如果$$m=0$$，尺度因子b的采样间隔为$$T_s$$，那么在$$a=2^m$$时，采样间隔可以取$$2^mT_s$$。此时小波函数我就不写出来了（

离散小波变换的离散其实就是是指对a和b取值的离散化，而并非对$$f(t)$$的离散化。

尽管如此，离散小波变换仍人具有一定大小的冗余度，而且不再满足时移不变性，尽管在数字处理上提供了便捷。

对尺度因子a的离散化中，如果取$$a_0=2$$，而b连续取值，这样的小波被称为二进小波。二进小波处于连续小波和离散小波之间，仍具有连续小波变换的时移不变性（毕竟时间尺度b是连续的）。正因如此，该算法在奇异性检测，图像处理中十分有用。二进小波变换往往就写作WT，除了对a进行替换外没有什么不同之处。不过二进小波也是冗余的。

#### 正交小波变换及其快速算法

后面这一段写的时候还没学，只好先随便说说啦

以上我们为了解冗余问题而引入了离散小波和二进小波，然而这两个变换仍然有一定的冗余，计算上的效率还是会更低，在数值计算和数据压缩角度来看仍然不能得到满意的效果。我们希望找到一组正交基，组成正交小波基。

如果我们在离散小波的基础上令$$a_0=2,T_s=1$$，那么我们的

$$\psi_{j,k}(t)=2^{-\frac{j}{2}}\psi(2^{-j}t-k)$$

就构成了一组正交基。至于如何构造本课程不予涉及。当尺度因子a较大时，对应时间窗较大，频率窗较小，该尺度下不能表示信号的细微变化，只表示信号的缓变信息，反之可以表示信号的细微变化，但实际上也能表示信号的缓变信息。针对尺度而言我们认为大尺度因子下的信号信息包含在小尺度因子下的信号信息中。

坏了编不下去了。下次课听完再写吧orz。



#### 基于小波变换的信号去噪

信号中混叠噪声是很常见的问题，或者说是不能避免的问题，我们在传统手段（傅里叶变换）中，要使信号和噪声频带重叠尽可能的小，这样就能避免噪声。但是如果信号与噪声在频域上已经混在一起，则使用傅里叶变换是很难去除了，此时就要换一组向量基尝试了。小波系数具有集中的能力，能够使信号的能量在小波域上集中在少数小波系数上，而噪声的能量分散在大量的小波系数上。因此信号的小波系数值将大于噪声的小波系数值，我们可以直接做一个阈值处理去除噪声。

常用的硬阈值法和软阈值法各有优势，软阈值处理信号的光滑性好，但是从2-范数误差最小的观点来看硬阈值更佳。但是硬阈值会让信号产生不期望的振荡。

使用阈值处理法需要考虑到抑制噪声和保留信号细节之间的权衡问题。阈值高时抑制噪声效果好，但是也会损失一些信号细节。阈值较低时去噪不充分。

MATLAB工具箱wavedemo是一个小波变换工具箱。







## 六、 作业题解

### 作业1

#### 1. 

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/quesI.png)

**离散时间傅里叶变换（DTFT）**公式为

$$X(e^{j\omega})=\sum\limits_{n=0}^{N}x(n)e^{-j\omega n}$$

带入求解，将余弦信号拆成两个复频率的和进行求和。也可以认为是一个sinc信号卷积两个峰值。这个信号相当于无限长余弦信号加矩形窗。

如果计算的话，可以计算为

$$\sum\limits_{n=0}^{N-1}e^{-j\omega n}=D(e^{j\omega})=\frac{1-e^{-j\omega N}}{1-e^{-j\omega}}=e^{-j(N-1)\omega/2 }\frac{sin(\omega N/2)}{sin(\omega /2)}$$

这个DTFT相当于两个数字Sinc函数叠加

**离散傅里叶变换（DFT）**为DTFT的单周期采样。

$$X(k)=\sum\limits_{n=0}^{N-1}x(n)e^{-j\frac{2\pi}{N}nk}$$

和上面的公式相比就是将$$\omega$$进行了采样。采样时$$\omega=2\pi k/N$$

这里采样点数为12点。那么将得到几个离散点。根据常识应该是离散谱线两条。

**补零后得到2N长度序列，重新求解**。根据性质我们知道，补零的时候可以让点数增加，使结果看起来更加密集，但是实际上不会改变频率分辨率。因此结果相当于做了插值，但是计算起来较为麻烦了。DTFT不会有明显变化，因为后面系数都是0，但是DFT会变得密集。**DFT就是DTFT在一个周期内的采样**。

------



#### 2. 

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/quesII.png)

采样频率是20KHz，则在DFT中，最大实际频率就是20KHz，有效部分是10KHz区域。k=150这里按照比例计算可以知道，频率应该是150/500*10K=3KHz，但是关于k=700的问题，这里我觉得存在问题。这里的700应该镜像到300的位置，表示6KHz，但是答案给的是14KHz。

圆周频率直接按照$$\pi$$的比例来就行了。

------

#### 3. 

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/quesIII.png)

题目的意思是首先对N点序列求DTFT，然后对结果进行单位圆上的等间隔抽样。这个过程不就是求DFT么。一共求了M点DFT。对这个结果进行反变换，求解这个M点时序序列$$y(n)$$和N点时序序列$$x(n)$$的联系。

思路一：

首先按公式求出x的DTFT，然后做抽样，求解DFT，最后求反变换，按照上述步骤计算最后可以化成两个求和。继续推公式可以求出x和y的关系

思路二：

整理的时候会发现实际上就是N点的x做了M点的DFT和IDFT。我们说变点数的DFT之间的关系就可以写作

$$y(n)=\sum\limits_{r=-\infty}^{\infty}x(n-rM)$$

即原N点序列的平移M点加和。

#### 4. 

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/quesIV.png)

信号$$\{ 1,2,3,4\}$$通过系统$$\{ 4,3,2,1\}$$，如果直接计算**线性卷积**，可以采用表格法进行计算，也可以滑动求和。对于**循环卷积**，可以采用定义法计算，将信号序列按逆时针排列成圆放过在内圈，将传递函数按顺时针排列放在外圈，将对应项对齐后进行对应项乘积求和。对下一时刻，可以将内圈顺时针转一个位置，也可以将外圈逆时针转一个单位，继续进行同样的计算。

**循环卷积计算线性卷积的方法**，首先根据要求补零，已知计算结果是$$M+N-1$$长度，因此需要进行补零到这个长度，然后利用圆周卷积计算法进行计算即可。

这两个卷积运算结果是相同的，但是圆周卷积计算的结果点数与原来信号的点数相同，而且也只有点数相同的信号可以进行运算。

**快速算法**，首先补零，然后计算对应点数的DFT。DFT后进行乘积运算，将结果做对应点数的IDFT。

#### 5.

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/quesV-I.png)

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/quesV-II.png)

用第三题的结果。b=3。

#### 6.

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/quesVI-I.png)

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/quesVI-II.png)

直接做DFT得到的结果是分离谱线。

如果在原信号的基础上增加点数，实际上并没有增加采样频率。对于同一个信号，不同长度但间隔相同，变换结果也是相同的，不同的只是补零，相当于做了个频域的内插。

但是对于8点序列，如果要计算16点DFT，我们可以确定结果是原来的8点序列内插一个插值点。至于结果如何不用精确计算。如何得出这样的结论？

DFT运算公式为$$X(k)=\sum\limits_{n=0}^{N-1}x(n)e^{-j\frac{2\pi}{N}nk}$$，观察公式我们可以看出，当k/N为一定值时，与前一问计算结果相同，可以确定偶数点的计算结果是与8点DFT相同的。其他位置是一个插值，可以随手画一下。

#### 7. 

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/quesVII.png)

 频率分辨率问题。可以计算64点DFT的频率分辨率，是$$\frac{2\pi}{64}$$，即$$\frac{\pi}{32}$$。对于信号1，其频谱间隔最小值为$$\frac{\pi}{64}$$，因此不能分析该信号的两个峰；显然第二个就是在分辨率允许范围内的。但是仍要考虑一些其他因素。第二个信号的最小频谱间隔为$$\frac{5\pi}{64}$$，此时是有可能出现频谱叠加在一起出现新的峰值的问题的。对于第三个信号而言，因为另一个频率分量太小了，首先显示时就看不到；其次，如果这个操作是加窗操作，那么一定会出现不同程度的泄漏问题。稍有泄漏，这个信号就有可能淹没在泄露的频谱中。

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/hw1.7.png)

#### 8. 

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/quesVIII.png)

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/quesVIII-II.png)

首先这个图是一个128点的，图上显然是第8和16点，那么对应的就是$$\pi/8$$和$$\pi/4$$。

显然高频率的幅度高三倍左右，而且又是一个幅度谱，相位信息不会影响结果。

注意一个DFT的性质，如果在时域中幅度为1，在频域中这一项对应的高度最大值应当是点数N，如果有分量谱线，则考虑帕斯瓦尔定理。对于弦函数来说，结果是各分一半的关系。



### 作业2

实际上这一部分才是重点。

#### 1. 

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/hw2ques1.png)

实正弦信号就是sin，复正弦信号就是$$e^{j\omega}$$。对于100K的采样频率来说，如果中心频率为10K，则两对称谱线就是10K和90K，如果采样40K信号，就是40K与60K的对称谱线。

采样后二倍抽取，这个就很神秘了。二倍抽取的本质为降采样过程，降低了采样速率（降为1/2）。首先对信号滤波，防止出现信号的混叠（抗混叠滤波器），这个滤波器在这里没有要求设计，实际要观察一下频谱变化来设计一下。

抗混叠后，采样速率会降为50K。从数字频率来理解这个问题，数字频域上信号频谱会扩张2倍，但是此时最高的$$2\pi$$已经变成了新的$$f_s'=50KHz$$。

两组结果相同，均为10K和40K。

这一题原来存在第三问，由于超纲删去了。是个处理增益的问题。如果先进行100K采样后进行两倍抽取就会比直接50K采样高3dB的SNR，因为100KHz的采样会把噪声分摊到100K带宽中，噪声功率谱密度总体降低一倍。

#### 2. 

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/hw2ques2.png)

毫无考点的一道题。主要考察在上采样后的信号出现的镜像频率在什么位置。上采样的变换过程在数字域可以理解为，频谱收缩M倍，然后原位置仍为$$2\pi$$，这样M倍上采样就是获取了M个相同的频谱。但是实际频率的大小仍然不发生改变。因此实际频率的取值仍然可以写作45K和65K，但是数字域上的通带频率和阻带频率都会变为原来的1/3。毫无考点。

#### 3. 

采样率转换中使用多级实现的必要性，并说明多级实现相对于单级实现采样率转换需要注意的问题。

1. 采样率转换多级实现的必要性：首先**单级实现**是**有限**度的，不能无限制的实现需要的放大倍数，其次如果想要实现**非整数倍**的采样速率变换，那么就需要采用多级实现。
2. 需要注意的问题：多级实现的时候带内波动会累加，因此要严格控制带内波动；多级实现可以考虑先上采样后下采样，可以节省滤波器；噪声叠加，要注意抑制噪声。

#### 4.

阐述多相实现结构在采样率转换系统中的作用

多相实现可以实现**并行处理**。另外多相处理出现的意义实际上是降低滤波器对处理速度的需求。因为往常情况下滤波器都是工作在高速端口的，这样可以让滤波器工作在低速端口。

#### 5.

阐述半带滤波器的时域系数特点和其可高速实现的原因，并简单说明其作为2倍抽取滤波器时的抗混叠情况

所谓半带滤波器，就是频域上通带和阻带各自的截止位置关于$$\pi/2$$对称。

理想半带滤波器在频域上就是一个矩形，因此频域系数都是1；即使不是理想半带滤波器，频域上也是一个满足无码间串扰条件的滤波器。时域上，由于满足了无码间串扰的频域条件，因此结果是有一半的点为0。所以可以节省一半的乘法运算。

二倍抽取时在通带$$\omega_c$$之外就会发生混叠，在其中时就会较为稳定，因此要求信号有效范围在$$\omega_c$$以内。

#### 6.

阐述CIC滤波器的系数特点和其可高速实现的原因，并给出多级CIC滤波器的优缺点。

CIC滤波器看起来就是个矩形窗一样的结构（时域）。这样时域系数就都是1，不用进行乘法运算，只用进行加法运算。一般的积分梳状滤波器可以达到最快的处理速度。

多级的优点：CIC滤波器阻带衰减不足，多级实现可以有利于阻带衰减提高

缺点：多级实现会出现一个与内插（抽取）因子有关的处理增益（从而导致运算溢出），而且积分梳状滤波器的带内波纹也比较明显，会在多级中叠加。

### 作业3

#### 1. 

短时傅里叶变换的基本思想是什么？优缺点为？

基本思想是对信号进行**加窗截断**后再进行傅里叶变换，这样就可以处理长度很长的信号，可以分析窗内信号的局部特征。

优点是终于可以**时频联合分析**了，在频域定位精准的同时还可以有一定的时域定位性，即变换结果终于**既含有时间信息又含有频率信息**。原本的傅里叶变换完全没有时域定位性。

缺点是固定的窗只能分析一定频率范围的信号，对于超出范围的信号分析能力很差。短时傅里叶变换的窗口大小固定，而且与信号本身没有什么关系，对于**高频与低频混合**信号与**长期无有效信息**的信号不能同时做到很好的分析识别处理。

#### 2. 

什么是窗口面积？试分析窗口面积随着a 和b 的改变发生变化吗？

一个算法的**时域窗口**与**频域窗口**的长度乘积就是窗口面积，这大小是不随a和b变化的。首先b的大小不会影响到窗口大小，只会影响时移。a越大，1/a越小，此时时域就会延展，相应的频域就会做收缩，通过积分变换的性质容易看出窗口大小与a的变化无关。

两个大小之间是相互制约的。

#### 3. 

为什么小波变换被称为变分辨率的时频联合分析法？

尺度因子a较大时，时间窗较大而频率窗较小，中心频率较小，分析低频成分

，反之分析高频成分。这时做的是频域分析，而如果改变b，就是时域分析。

因为小波母函数是一组满足了特定条件的基函数的平移与变换得到的，因此其窗函数大小可以适配很多频率的情况，从而达到时频域的联合分析。

#### 4. 

a-b域内的任意函数是否都能看作是一个信号的x的小波变换系数吗？

显然不能，因为小波变换系数还要满足再生核方程，不满足这个条件就不能做反变换得到原信号。

#### 5.

对某一函数x(t)进行离散小波变换，是对t进行离散化吗？

离散小波变换离散的a和b而非对t进行

#### 6.

连续小波变换、离散小波变换和二进小波变换中，哪种变换不具有时移不变
性？为什么？

离散小波变换没有时移不变性。

连续小波和二进制小波有时移不变性。因为这两种变换对时域因子b都没有离散化处理。如果未进行该处理，经过积分变换（线性变换）的结果应仍然是满足时域不变性的，但是离散变换对b做了离散化，就不能保证每一个时域变化都能对应离散的结果。

#### 7.

画出某一序列f(n)进行二级正交小波分解与重构的框图。

![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/wt2.png)

从滤波器组的角度看，实际上这个过程就相当于过正交滤波器组。假设$$h_0,h_1$$是一对双通道滤波器，其中0具有低通性，1具有高通性，两个滤波器输出分别代表了原离散信号的低频概貌和高频细节。原始频带信息经过滤波器组后分成两部分，输出带宽只有原来序列的一半，进行两倍下采样后不会丢失信息。经过如此反复抽取后就对信号进行了N级正交小波分解与重构。随着分解级数的增加，尺度因子a增大，输出信息越低频。



![ADSP](https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/IWT2.png)

重构就是将上述过程反着来一遍。随着重构进行，尺度因子a逐渐减小。

#### 8. 

一些噪声噪声在小波域中会集中在少数一部分小波向量基中，而在其他大部分向量基中比较分散，因此可以对这几个向量基进行阈值处理来去除一定强度的噪声。

#### 9.

- 首先进行小波变换

这里可以写一下是咋变的，例如Y=WT(X)这样的

- 选定正交基进行阈值处理

选正交基并把它阈值阈值掉的方法很多，有硬阈值（2范数误差更小）和软阈值（光滑性好）等

- 进行小波反变换

将结果变回去



# 复习提纲

想到啥写啥，思想深度局限于大三学生水平，2018-11-2 12:43:05。

1. vanilla - 傅里叶变换就是将单周期内能量有限的信号变到频域中。因为单周期信号必然是时域有限的，结果必然是频域无限的信号。
2. 傅里叶变换的概念实际上是从傅里叶级数上引来的，傅里叶级数是最开始的将函数分解的操作，将一个周期内能量有限的信号分解为不同频率的弦函数和，因为频率都是基频的整倍数，所以结果都是离散谱线。当我们把周期拉长，频域上的谱线就会越来越近，这样就构成了连续的谱线，即我们说的傅里叶变换。
3. 对傅里叶变换做采样仍然能得到傅里叶级数
4. 很小的时候我也想过这个问题，计算机要怎么计算DTFT。我以为是我太菜了，没想到确实没啥办法高效地算。
5. 如果我们记$$X(j\Omega)$$为连续信号的傅里叶变换，$$X(k\Omega_0)$$为傅里叶级数，他们之间就存在一个绝对关系（如果说两者谱线之间的相对关系相同的话），可以说二者之间的幅度绝对差为$$T$$，傅里叶级数的谱线高度是傅里叶变换的$$1/T$$。级数代表的是K次谐波的大小，变换表示的是不同频率分量的能量密度
6. 量纲上看也可以认为$$X(j\Omega)$$等于谐波幅度比$$\Omega_0$$，因此我们说傅里叶变换的结果是频谱的密度
7. 帕斯瓦尔，用过都说好。
8. 实际上我们还可以对周期信号做傅里叶变换。只不过得到的结果仍然是间距为$$\Omega_0$$的冲激串，其中冲激串的强度是傅里叶级数的$$2\pi$$倍。在无穷小的频率范围内取得了无穷大的频谱密度。
9. 为什么经典数学意义上周期信号不能做傅里叶变换呢，因为傅里叶变换针对的目标就是能量有限的信号，而周期信号在数学意义上能量是无限的，只是功率有限而已，因此得到的频谱密度是无穷大的。
10. 单个复正弦只有一条谱线，实正弦是有两条谱线的，而且sin有正反，cos全正，注意还有个系数$$2\pi$$。变换过程有$$2\pi$$，卷积定理有个$$1/2\pi$$就消了，并不是没有。
11. 时域冲激串的FT，周期为$$T$$的冲激串的傅里叶变换仍为冲激串，间隔为$$1/T$$。
12. 处理信号才不用连续模拟信号，一般都采用离散信号，因此有离散时间傅里叶变换。离散时间和离散概念是不同的，离散时间只是离散时间，离散是全部离散。
13. 混叠的概念要弄明白啊，自己要会画图，降采样的时候在数字域画一画，直接把$$\pi$$以内的谱扩展M倍就行了，对称看看混叠是啥样的，哪里会混叠。
14. z变换就是把$$e^{j\omega}$$换成$$z$$，
15. 我觉得老师说本课程不强调DTFT是不是在暗示什么东西（
16. 总之正着边就是乘$$e^{-j\omega n}$$求和的问题，反着变就是乘$$e^{j\omega n}$$积分的问题。反变换系数$$1/2\pi$$。
17. 时域离散化带来的结果就是频域的周期化，但是实际问题中的变换一定是以离散为基础的，因此需要变换结果也是离散的方法。离散傅里叶变换提供了方法，首先将信号做周期延拓，这样得到的结果必然是离散的；但是离散信号的变换有周期性，因此我们要对周期信号截取一个周期。DFT的基本思想即是如此。从一个离散周期到另一个离散周期的变化过程是这个变换的中间过程，有时候也叫他DFS（离散傅里叶级数）。
18. 相比于离散时间傅里叶变换，离散傅里叶级数变换时对$$\omega$$做了采样。也就是说，DFT相当于对DTFT做了频域采样，采样点为k点，采样位置均匀，是$$2\pi k/N$$。变换回来的时候还有一个$$1/N$$的系数。
19. N点矩形窗的变换结果为$$\frac{sin(\omega N/2)}{sin(\omega/2)}$$。那么最高点位置就是N，零点位置也很明显了。主瓣宽度为$$4\pi/N$$。
20. 主瓣宽度可以说是频率分辨率了。
21. 卷积后原来为0的位置发生了值的变化的过程叫频谱泄漏。旁瓣越大衰减越慢，泄漏越严重。
22. 主瓣宽度和旁瓣幅度是不能同时减小的，这就和时间窗与频率窗不能同时减小一样。窗大小和频率分辨率有关，一般窗越大分辨率越高，分辨能力越强。
23. 抽样的精髓就是不损失信号的信息。不损失信息的最朴实方法就是提高采样速率，一般采样率要高于最高频率的两倍，实际应用中三到五倍都是存在的。
24. 实际抽样定理要考虑信号的带宽。
25. 原来抗混叠滤波器是模拟滤波啊，发生在抽样前。
26. 信号的重建过程其实是无穷多的sinc函数的加权移位，插值公式就不细写了。
27. 实际中采用两倍频对正弦信号抽样后得到的点根本就不能看出是正弦抽样，但是神奇的地方就在于理想低通还是能完美恢复出原来的信号。我是不是可以说，在采样过程中丢失的信息实际上是可以通过理想低通滤波重建后恢复出来？
28. 截断后的数据包含整周期一般就不会出现泄漏问题了。
29. DFT是一个正交变换。正交变换好处都有啥，系数没有冗余，运算简单。
30. 循环卷积也可以写成矩阵的乘积，就是一方循环移位与另一方求积的问题。从圆周的角度来看，两个圆周中x和h反向旋转排列，只将0位置对齐。然后任意一个序列朝向自己旋转方向的反方向旋转一个位置，这个乘积就是第二个值。
31. 循环卷积计算线性卷积需要补零到合适长度，使用DFT计算仍然需要补零。相当于说，DFT乘法在时域中对应的是循环卷积。
32. 补零可以让谱线看的更清晰，但是频率分辨率不会改变的。
33. 吐槽一句国内啥起步都晚，国外研究剩下的东西我们才刚起步。不知道学术界到底有多少水分，但是感觉很多东西在国内研究就不行啊。
34. 下采样的一个关键步骤就是抽取，但是抽取前要先过滤波器。按整数倍抽取是有周期时不变性的。
35. 下采样之后**频谱幅度要M倍缩小**，并且做**M倍展宽**。这样的操作并不会影响信号的能量。
36. 抗混叠滤波器将信号带限到$$\pi/M$$，如果信号不在这个范围内就会被滤掉，但是如果高于这个频率就会混叠。
37. 上采样与下采样并不完全相同。下采样只是去除了一部分点，上采样却在往里面加点。这样的情况下信息应该是增加了，原信号应该被破坏了才对。
38. 上采样后频谱被压缩了L倍，但是高度不会增加，因为一个$$2\pi$$周期内的谱变多了。镜像频率插入位置是等间隔插入对称中心的。
39. 多倍上采样可以实现上变频，采用带通方式滤波。
40. 实际应用中会需要完成较大倍数的抽取或内插，此时需要滤波器很住宅的通带过渡带，需要很高阶滤波器去实现。因此采用多级。
41. $$N=\frac{\delta (dB)-7.95}{14.36*BW(MHz)}*f_s(MHz)+1$$
42. 多级实现能提高可实现性，但是带内波动会累加，平坦度要求提升。
43. 滤波器设计原则是信号失真最小，复杂度低，结构简单，实时性好。
44. 抽取是一个线性操作（吧），可以在信号合并后一起抽，也可以先各自抽完再合并。
45. 抽取后再延迟一个，相当于先延迟M个再抽取。因为M倍抽取后M个点就只剩下一个了，延迟一个效果相同。
46. 高阶系统$$H(z^M)$$后下采样相当于下采样后进入低阶系统$$H(z)$$。
47. 对于内插这些结论相反。上采样也是一个线性（？）操作，但是上采样后就需要延迟L个单位了（点变多了），并且先经过上采样时需要高阶系统的处理，否则可以低阶系统处理完再内插。
48. FIR的直接实现结构就是延迟——乘法——加法的组合。先抽取后乘法相当于每M个点只需要计算一个点，而不像后抽取是直接丢弃已经算好的点。这样虽然用了很多的抽取器，但仍然是一个高速实现结构。
49. 系数对称的滤波器乘法次数还可以更少，因为相同的系数可以复用。
50. 上采样中，首先对信号进行内插，然后经过横向滤波器。这里滤波器实现方式略有不同，实际上也都差不多，先增益和先延迟有什么区别。达到了对称的效果，所以就后延迟了。
51. 但是先内插也是先内插0，这些不需要经过计算，所以可以先做乘法后进行内插。
52. 目前为止的滤波器都是工作在高速率端口的，这就要求滤波器有很高的计算速度。
53. 高阶的FIR滤波器可以由基于多相分解的并行结构来实现（复杂的高阶FIR可以换一种实现方式），分解原来的传递函数为M个低阶传递函数，称之为多相分量，M个低阶传输函数之和等效于原始传输函数。**多相表示**
54. FIR滤波器的z变换表示形式就是滤波器的时域系数与延迟的乘积。对于N阶的，我们可以将表达式按照奇偶分为两部分。如果我们将偶数部分中的一个z取出（或者**取出奇数部分的$$z^{-1}$$**），就能写成一个新的表达式。这是一个二相分解。
55. 多相分解就需要分解为M个不同的系数假设分解为3组，就是0,3,6,9...一组，1,4,7,10...一组，2,5,8,11一组，对于M分组也是类似。最终形式就是$$\sum\limits_{K=0}^{M-1}\sum\limits_{n=-\infty}^{\infty}h(nM+K)z^{-(nm+K)}$$
56. 看上面的式子，规律就是每隔M个取一个值，偏置K取值范围是0到M-1，另外z上面的系数总是与h中的反号。
57. 稍加整理可以写成$$\sum\limits_{K=0}^{M-1}z^{-K}E_K(z^M)$$
58. 其中$$E_K(z^M)$$就是里面的那些。因为变元是一个M阶量，因此是一个高阶系统。令$$E_K(z)=\sum\limits_{n=-\infty}^{\infty}h(nM+K)z^{-n}$$
59. 注意每一组分到的量可以不完全相同。不够整除的时候可以向下取整代替。这样每一个多相分量都是一个M阶分量，但是由于系数是含M，又可以通过恒等关系三消去这个M，实际应用一下我们可以发现，如果以抽取为例，如果将抽取移动到传递函数之前，传递函数可以写成一个低阶系统。这个低阶传输函数在应用时可以直接计算出结果。
60. 经过这样的操作就可以让滤波器工作在低速率端。降低了实时性要求。实际系统工作时实时性下降了。多相支路输入序列实际变成了原序列每隔M个抽样的新序列了。至少滤波器现在工作在了低速率端口。
61. 这个多相分解就是巧妙利用了内插和抽取的主要思想。实际上我们的高效结构就是多相结构的一个特例。多项结构的增益是需要自己计算的，但是高效结构使用的仍然是一个系数。
62. 直观理解一下计算次数。直接型就是有多少点就算多少次乘法，每次N个点过去，每秒f次，因此需要Nf次。如果先抽取，每次运算量就变成了1/M次
63. 上采样是增加点数，因此每次会有NL点计算，直接方式就是NLf次，而高效算法只需要对一个点进行计算，其他内插都是0，因此是Nf次。对于对称结构，还可以少一半的运算次数。
64. 多相结构还可以降低滤波器阶数，像抗混叠滤波器与抗镜像滤波器的阶数就降低为1/M和1/L。
65. IIR实现起来复杂度较低，阶数也更少，但是没有线性相位。IIR的运算量甚至要低于多相结构的FIR。
66. IIR滤波器简单是简单，但是对量化噪声敏感，而且非线性相位，实时性也差。锁相环的环路滤波会采用这种滤波器。
67. 一看环路滤波器的形式就能画成一个带反馈的结构。
68. 我靠IIR好难啊，还好不考，过了过了
69. 半带滤波器是一个满足无串扰条件的滤波器，滤波器关于$$\pi/2$$中心对称
70. 太对称了，连波纹都是对称的。就是因为满足了无串扰条件，所以时域的权值才是除了零点外的偶数点全为0。节约一半计算量。
71. 理想半带滤波器就是个$$\pi/2$$低通。
72. 不理想的半带滤波器只能用于两倍抽取，而且肯定会有混叠，因此一般要求信号在$$\omega_c$$之内，这样的信号不会被混叠，但是噪声混叠在信号上还是有可能的。
73. 积分梳状滤波器就是个Sinc函数，绝了。自己看一下积分滤波器和梳状滤波器级联，拼在一起刚好是Sinc的幅度谱。
74. 积分梳状滤波器所有系数都是1，因此不用乘法。
75. 积分梳状滤波器阻带一直很差，这对应了其主瓣宽度窄。阻带抑制13.46dB，为了改善这个，一般会采用多级级联，但是一般要给每一级留出足够的精度，因为随着级联增加，抽取因子增大，处理增益会越来越大。指数增大。
76. 带内容差是累积的。带宽越小，平坦度越好。我觉得这是句废话，这个函数是Sinc，你当然带宽越小越平了。
77. 多级可以降低混叠影响，但是这个滤波器是不满足无混叠条件的，无论如何都会出现混叠。
78. 信号的变换就是从一个域到另一个域。从某种角度上来说，信号变换的时候能保留的信息量是有限的。例如傅里叶变换中只能保留频率的信息，时间的信息虽然能恢复但是在频域中看不出来；同理当一个信号以小波变换到小波域的时候，信号的时域和频域都只能保留部分信息。虽然是时频联合分析，但是频域信息并不是那么完整。
79. 高斯白，幅度分布高斯，频域分布白。
80. 如何对两个信号的相关性作出考量？两个信号之间存在的相关关系可以用互相关函数来表示，互相关函数如下所示（离散信号换成求和就好了）
81. $$R=\int_{-\infty}^{\infty}f(t)g(t+\tau)dt$$
82. 还存在一个相关系数，我们用r来表示。相关函数表现的是两个函数的相关性，在间隔时间$$\tau$$时的表现，相关系数则是描述两个信号总体的相关性。根据许瓦兹不等式，两个函数的内积平方小于等于分别自内积乘积，我们可以定义相关系数为两函数内积比分别内积乘积的开方。
83. 自内积实际上是能量。
84. 相关系数的比较就是两个信号之间的关系，但是两个弦信号之间求相关系数时，很可能只是因为相位差异得到的结果。这就是相关系数的局限性。这时候每隔一段时移判断一个相关系数的相关函数就变得有效。
85. 对于能量信号$$R(0)$$就是能量，而对于功率信号，这个值可能是无穷。在随机信号分析中这个代表的是平均功率。
86. 如果x是实信号，则自相关函数是实偶函数；如果x是复信号，则自先关函数是一个共轭对称函数。
87. 确知信号的分析与随机信号的确实不同，之前上课的时候还觉得一直在讲相同的东西，真的是很对不起老师了。
88. 互相关函数虽然不是偶函数，但是$$r_{xy}(m)==r_{yx}(-m)$$











